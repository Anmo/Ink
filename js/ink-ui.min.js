
Ink.createModule("Ink.UI.Common","1",["Ink.Dom.Element_1","Ink.Net.Ajax_1","Ink.Dom.Css_1","Ink.Dom.Selector_1","Ink.Util.Url_1"],function(e,t,n,r,o){"use strict";var i={},a=0,s={},u=Object.keys||function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},l={Layouts:{SMALL:"small",MEDIUM:"medium",LARGE:"large"},isDOMElement:function(e){return e&&"object"==typeof e&&"nodeType"in e&&1===e.nodeType},isInteger:function(e){return"number"==typeof e&&0===e%1},elOrSelector:function(e,t){if(!this.isDOMElement(e)){var n=r.select(e);if(0===n.length)throw new TypeError(t+" must either be a DOM Element or a selector expression!\nThe script element must also be after the DOM Element itself.");return n[0]}return e},elsOrSelector:function(e,t,n){var o;if("string"==typeof e?o=r.select(e):l.isDOMElement(e)?o=[e]:e&&"object"==typeof e&&"number"==typeof e.length&&(o=e),o&&o.length)return o;if(n||2===arguments.length)throw new TypeError(t+" must either be a DOM Element, an Array of elements, or a selector expression!\nThe script element must also be after the DOM Element itself.");return[]},options:function(t,n,r,o){"string"!=typeof t&&(o=r,r=n,n=t,t=""),r=r||{};var i,a,c,d,f,h={},p=o?e.data(o):{},m=function(e){throw t&&(e=t+": "+e),new Error(e)};for(f in n)n.hasOwnProperty(f)&&(a=n[f][0],c=a.toLowerCase(),d=2===n[f].length?n[f][1]:s,a||m("Ink.UI.Common.options: Always specify a type!"),c in l._coerce_funcs||m("Ink.UI.Common.options: "+n[f][0]+" is not a valid type. Use one of "+u(l._coerce_funcs).join(", ")),(!n[f].length||n[f].length>2)&&m('the "defaults" argument must be an object mapping option names to [typestring, optional] arrays.'),i=f in p?l._coerce_from_string(c,p[f]):s,i!==s?(l._options_validate(i,c)||m("Invalid "+c+": "+i),h[f]=i):f in r?h[f]=r[f]:d!==s?h[f]=d:m("Option "+f+" is required!"));return h},_coerce_from_string:function(e,t){return e in l._coerce_funcs?l._coerce_funcs[e](t):t},_options_validate:function(e,t){return t in l._options_validate_types?l._options_validate_types[t].call(l,e):!1},_coerce_funcs:function(){var e={element:function(e){return l.elOrSelector(e,"")},elements:function(e){return l.elsOrSelector(e,"",!1)},object:function(e){return e},number:function(e){return parseFloat(e)},"boolean":function(e){return!("false"===e||""===e||null===e)},string:function(e){return e},"function":function(){throw new Error("This parameter is a function. Do not specify it through data-attributes! It's eval!")}};return e["float"]=e.integer=e.number,e}(),_options_validate_types:function(){var e={string:function(e){return"string"==typeof e},number:function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},integer:function(e){return e===Math.round(e)},element:function(e){return l.isDOMElement(e)},elements:function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&e.length},"boolean":function(e){return"boolean"==typeof e}};return e["float"]=e.number,e}(),clone:function(e){try{return JSON.parse(JSON.stringify(e))}catch(t){throw new Error("Given object cannot have loops!")}},childIndex:function(e){if(l.isDOMElement(e))for(var t=r.select("> *",e.parentNode),n=0,o=t.length;o>n;++n)if(t[n]===e)return n;throw"not found!"},ajaxJSON:function(e,n,r){new t(e,{evalJS:"force",method:"POST",parameters:n,onSuccess:function(e){try{if(e=e.responseJSON,"ok"!==e.status)throw"server error: "+e.message;r(null,e)}catch(t){r(t)}},onFailure:function(){r("communication failure")}})},currentLayout:function(){var e,t,o,i,a,s=r.select("#ink-layout-detector")[0];if(!s){s=document.createElement("div"),s.id="ink-layout-detector";for(o in this.Layouts)this.Layouts.hasOwnProperty(o)&&(i=this.Layouts[o],a=document.createElement("div"),a.className="show-"+i+" hide-all",a.setAttribute("data-ink-layout",i),s.appendChild(a));document.body.appendChild(s)}var u="",l=0;for(e=0,t=s.childNodes.length;t>e;++e)a=s.childNodes[e],"block"===n.getStyle(a,"display")&&(u=a.getAttribute("data-ink-layout"),l+=1);return 1===l?u:"large"},hashSet:function(e){if("object"!=typeof e)throw new TypeError("o should be an object!");var t=o.getAnchorString();t=Ink.extendObj(t,e),window.location.hash=o.genQueryString("",t).substring(1)},cleanChildren:function(e){if(!l.isDOMElement(e))throw"Please provide a valid DOMElement";for(var t,n=e.lastChild;n;)t=n.previousSibling,e.removeChild(n),n=t},storeIdAndClasses:function(e,t){if(!l.isDOMElement(e))throw"Please provide a valid DOMElement as first parameter";var n=e.id;n&&(t._id=n);var r=e.className;r&&(t._classes=r)},restoreIdAndClasses:function(e,t){if(!l.isDOMElement(e))throw"Please provide a valid DOMElement as first parameter";t._id&&e.id!==t._id&&(e.id=t._id),t._classes&&-1===e.className.indexOf(t._classes)&&(e.className?e.className+=" "+t._classes:e.className=t._classes),t._instanceId&&!e.getAttribute("data-instance")&&e.setAttribute("data-instance",t._instanceId)},registerInstance:function(e,t,n){if(!e._instanceId){if("object"!=typeof e)throw new TypeError("1st argument must be a JavaScript object!");if(!e._options||!e._options.skipRegister){if(!this.isDOMElement(t))throw new TypeError("2nd argument must be a DOM element!");if(void 0!==n&&"string"!=typeof n)throw new TypeError("3rd argument must be a string!");var r=(n||"instance")+ ++a;i[r]=e,e._instanceId=r;var o=t.getAttribute("data-instance");o=null!==o?[o,r].join(" "):r,t.setAttribute("data-instance",o)}}},unregisterInstance:function(e){delete i[e]},getInstance:function(e){var t;if(this.isDOMElement(e)){if(t=e.getAttribute("data-instance"),null===t)throw new Error("argument is not a DOM instance element!")}else t=e;t=t.split(" ");var n,r,o,a=t.length,s=[];for(o=0;a>o;++o){if(r=t[o],!r)throw new Error("Element is not a JS instance!");if(n=i[r],!n)throw new Error('Instance "'+r+'" not found!');s.push(n)}return 1===a?s[0]:s},getInstanceFromSelector:function(e){var t=r.select(e)[0];if(!t)throw new Error("Element not found!");return this.getInstance(t)},getInstanceIds:function(){var e=[];for(var t in i)i.hasOwnProperty(t)&&e.push(t);return e},getInstances:function(){var e=[];for(var t in i)i.hasOwnProperty(t)&&e.push(i[t]);return e},destroyComponent:function(){l.unregisterInstance(this._instanceId),this._element.parentNode.removeChild(this._element)}};return l});
Ink.createModule("Ink.UI.Modal","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1"],function(e,t,n,r,i,o){"use strict";function a(e){return e[0].toUpperCase()+e.replace(/^./,"")}function s(e){return"max"+a(e)}var l=[],u=function(o,a){if(this._element=o?e.elOrSelector(o,"Ink.UI.Modal markup"):null,this._options={width:void 0,height:void 0,shadeClass:void 0,modalClass:void 0,trigger:void 0,triggerEvent:"click",autoDisplay:!0,markup:void 0,onShow:void 0,onDismiss:void 0,closeOnClick:!1,closeOnEscape:!0,responsive:!0,disableScroll:!0},this._handlers={click:Ink.bindEvent(this._onShadeClick,this),keyDown:Ink.bindEvent(this._onKeyDown,this),resize:Ink.bindEvent(this._onResize,this)},this._wasDismissed=!1,this._markupMode=this._element?n.hasClassName(this._element,"ink-modal"):!1,this._markupMode){if(this._modalDiv=this._element,this._modalDivStyle=this._modalDiv.style,this._modalShadow=this._modalDiv.parentNode,this._modalShadowStyle=this._modalShadow.style,this._contentContainer=i.select(".modal-body",this._modalDiv)[0],!this._contentContainer)throw new Error('Ink.UI.Modal: Missing div with class "modal-body"');this._options.markup=this._contentContainer.innerHTML,this._options=Ink.extendObj(this._options,r.data(this._element))}else this._modalShadow=document.createElement("div"),this._modalShadowStyle=this._modalShadow.style,this._modalDiv=document.createElement("div"),this._modalDivStyle=this._modalDiv.style,this._element&&(this._options.markup=this._element.innerHTML),n.addClassName(this._modalShadow,"ink-shade"),n.addClassName(this._modalDiv,"ink-modal ink-space"),this._modalShadow.appendChild(this._modalDiv),document.body.appendChild(this._modalShadow);if(this._options=Ink.extendObj(this._options,a||{}),this._markupMode||this.setContentMarkup(this._options.markup),"string"==typeof this._options.shadeClass&&n.addClassName(this._modalShadow,this._options.shadeClass),"string"==typeof this._options.modalClass&&n.addClassName(this._modalDiv,this._options.modalClass),"trigger"in this._options&&"undefined"!=typeof this._options.trigger){var s;"string"==typeof this._options.trigger&&(s=i.select(this._options.trigger),t.observeMulti(s,this._options.triggerEvent,Ink.bindEvent(this.open,this)))}else"true"===this._options.autoDisplay.toString()&&this.open()};return u.prototype={_reposition:function(){this._modalDivStyle.marginTop=-r.elementHeight(this._modalDiv)/2+"px",this._modalDivStyle.marginLeft=-r.elementWidth(this._modalDiv)/2+"px"},_onResize:function(e){"boolean"==typeof e?this._timeoutResizeFunction.call(this):!this._resizeTimeout&&e&&"object"==typeof e&&(this._resizeTimeout=setTimeout(Ink.bind(this._timeoutResizeFunction,this),250))},_timeoutResizeFunction:function(){var e={width:-1!==(""+this._options.width).indexOf("%"),height:-1!==(""+this._options.height).indexOf("%")},t={height:r.viewportHeight(),width:r.viewportWidth()};o.forEach(["height","width"],Ink.bind(function(n){e[n]||(this._modalDivStyle[n]=t[n]>this.originalStatus[n]?this._modalDivStyle[s(n)]:Math.round(.9*t[n])+"px")},this)),this._resizeContainer(),this._reposition(),this._resizeTimeout=void 0},_onShadeClick:function(e){var o=t.element(e);if(n.hasClassName(o,"ink-close")||n.hasClassName(o,"ink-dismiss")||r.findUpwardsBySelector(o,".ink-close,.ink-dismiss")||this._options.closeOnClick&&(!r.descendantOf(this._shadeElement,o)||o===this._shadeElement)){for(var a=i.select(".ink-alert",this._shadeElement),s=a.length,l=0;s>l;l++)if(r.descendantOf(a[l],o))return;this.dismiss(),this._wasDismissed&&t.stop(e)}},_onKeyDown:function(e){27!==e.keyCode||this._wasDismissed||"true"===this._options.closeOnEscape.toString()&&l[l.length-1]===this&&(this.dismiss(),this._wasDismissed&&t.stop(e))},_resizeContainer:function(){this._contentElement.style.overflow=this._contentElement.style.overflowX=this._contentElement.style.overflowY="hidden";var e=r.elementHeight(this._modalDiv);this._modalHeader=i.select(".modal-header",this._modalDiv)[0],this._modalHeader&&(e-=r.elementHeight(this._modalHeader)),this._modalFooter=i.select(".modal-footer",this._modalDiv)[0],this._modalFooter&&(e-=r.elementHeight(this._modalFooter)),this._contentContainer.style.height=e+"px",e!==r.elementHeight(this._contentContainer)&&(this._contentContainer.style.height=~~(e-(r.elementHeight(this._contentContainer)-e))+"px"),this._markupMode||(this._contentContainer.style.overflow=this._contentContainer.style.overflowX="hidden",this._contentContainer.style.overflowY="auto",this._contentElement.style.overflow=this._contentElement.style.overflowX=this._contentElement.style.overflowY="visible")},_disableScroll:function(){var e=document.documentElement;this._oldHtmlOverflows=[e.style.overflowX,e.style.overflowY],e.style.overflowX=e.style.overflowY="hidden"},open:function(i){i&&t.stop(i);var u="CSS1Compat"===document.compatMode?document.documentElement:document.body;this._resizeTimeout=null,n.addClassName(this._modalShadow,"ink-shade"),this._modalShadowStyle.display=this._modalDivStyle.display="block",setTimeout(Ink.bind(function(){n.addClassName(this._modalShadow,"visible"),n.addClassName(this._modalDiv,"visible")},this),100),this._contentElement=this._modalDiv,this._shadeElement=this._modalShadow,this._markupMode||this.setContentMarkup(this._options.markup);var c={width:-1!==(""+this._options.width).indexOf("%"),height:-1!==(""+this._options.height).indexOf("%")};o.forEach(["width","height"],Ink.bind(function(e){void 0!==this._options[e]?(this._modalDivStyle[e]=this._options[e],c[e]||(this._modalDivStyle[s(e)]=r["element"+a(e)](this._modalDiv)+"px")):this._modalDivStyle[s(e)]=r["element"+a(e)](this._modalDiv)+"px",c[e]&&parseInt(u["client"+s(e)],10)<=parseInt(this._modalDivStyle[e],10)&&(this._modalDivStyle[e]=Math.round(.9*parseInt(u["client"+s(e)],10))+"px")},this)),this.originalStatus={viewportHeight:r.elementHeight(u),viewportWidth:r.elementWidth(u),height:r.elementHeight(this._modalDiv),width:r.elementWidth(this._modalDiv)},"true"===this._options.responsive.toString()?(this._onResize(!0),t.observe(window,"resize",this._handlers.resize)):(this._resizeContainer(),this._reposition()),this._options.onShow&&this._options.onShow(this),"true"===this._options.disableScroll.toString()&&this._disableScroll(),t.observe(this._shadeElement,"click",this._handlers.click),"true"===this._options.closeOnEscape.toString()&&t.observe(document,"keydown",this._handlers.keyDown),e.registerInstance(this,this._shadeElement,"modal"),this._wasDismissed=!1,l.push(this),n.addClassName(document.documentElement,"ink-modal-is-open")},dismiss:function(){if(!this._wasDismissed){if(this._options.onDismiss){var e=this._options.onDismiss(this);if(e===!1)return}if(this._wasDismissed=!0,this._options.responsive&&t.stopObserving(window,"resize",this._handlers.resize),this._markupMode?(n.removeClassName(this._modalDiv,"visible"),n.removeClassName(this._modalShadow,"visible"),this._waitForFade(this._modalShadow,Ink.bind(function(){this._modalShadowStyle.display="none"},this))):(this._modalShadow.parentNode.removeChild(this._modalShadow),this.destroy()),l=o.remove(l,o.keyValue(this,l),1),0===l.length){var r=document.documentElement;this._options.disableScroll&&(r.style.overflowX=this._oldHtmlOverflows[0],r.style.overflowY=this._oldHtmlOverflows[1]),n.removeClassName(r,"ink-modal-is-open")}}},_waitForFade:function(e,r){for(var i,o,a=["transitionEnd","oTransitionEnd","webkitTransitionEnd"],s=0,l=a.length;l>s;s++)if(o=a[s],i="on"+o.toLowerCase(),i in e)return t.observeOnce(e,o,r),void 0;var u=function(){+n.getStyle(e,"opacity")>0?setTimeout(u,250):r()};setTimeout(u,500)},destroy:function(){e.unregisterInstance(this._instanceId)},getContentElement:function(){return this._contentContainer},setContentMarkup:function(e){if(this._markupMode)this._contentContainer.innerHTML=e;else{if(this._modalDiv.innerHTML=[e].join(""),this._contentContainer=i.select(".modal-body",this._modalDiv),!this._contentContainer.length){var t=i.select(".modal-header",this._modalDiv),a=i.select(".modal-footer",this._modalDiv);o.each(t,r.remove),o.each(a,r.remove);var s=document.createElement("div");n.addClassName(s,"modal-body"),s.innerHTML=this._modalDiv.innerHTML,this._modalDiv.innerHTML="";var l=t.concat([s]).concat(a);o.each(l,Ink.bindMethod(this._modalDiv,"appendChild")),this._contentContainer=i.select(".modal-body",this._modalDiv)}this._contentContainer=this._contentContainer[0]}this._contentElement=this._modalDiv,this._resizeContainer()}},u});
Ink.createModule("Ink.UI.ImageQuery","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1"],function(e,t,n,r,i,o){"use strict";var s=function(t,n){if(!e.isDOMElement(t)&&"string"!=typeof t)throw"[ImageQuery] :: Invalid selector";if("string"==typeof t){if(this._element=i.select(t),this._element.length<1)throw"[ImageQuery] :: Selector has returned no elements";if(this._element.length>1){var o;for(o=1;o<this._element.length;o+=1)new Ink.UI.ImageQuery(this._element[o],n)}this._element=this._element[0]}else this._element=t;this._options=Ink.extendObj({queries:[],onLoad:null},r.data(this._element)),this._options=Ink.extendObj(this._options,n||{});var s;if(-1!==(s=this._element.src.lastIndexOf("?"))){var a=this._element.src.substr(s);this._filename=this._element.src.replace(a,"").split("/").pop()+a}else this._filename=this._element.src.split("/").pop();this._init()};return s.prototype={_init:function(){this._options.queries=o.sortMulti(this._options.queries,"width").reverse(),this._handlers={resize:Ink.bindEvent(this._onResize,this),load:Ink.bindEvent(this._onLoad,this)},"function"==typeof this._options.onLoad&&t.observe(this._element,"onload",this._handlers.load),t.observe(window,"resize",this._handlers.resize),this._handlers.resize.call(this)},_onResize:function(){clearTimeout(e);var e=setTimeout(Ink.bind(function(){if(!this._options.queries||this._options.queries==={})return clearTimeout(e),void 0;var t,n,r;for("number"==typeof window.innerWidth?r=window.innerWidth:document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?r=document.documentElement.clientWidth:document.body&&(document.body.clientWidth||document.body.clientHeight)&&(r=document.body.clientWidth),t=0;t<this._options.queries.length;t+=1)if(this._options.queries[t].width<=r){n=t;break}"undefined"==typeof n&&(n=this._options.queries.length-1);var i=this._options.queries[n].src||this._options.src;if("devicePixelRatio"in window&&window.devicePixelRatio>1&&"retina"in this._options&&(i=this._options.queries[n].retina||this._options.retina),this._options.queries[n].file=this._filename,"function"==typeof i&&(i=i.apply(this,[this._element,this._options.queries[n]]),"string"!=typeof i))throw'[ImageQuery] :: "src" callback does not return a string';var o;for(o in this._options.queries[n])if(this._options.queries[n].hasOwnProperty(o)){if("src"===o||"retina"===o)continue;i=i.replace("{:"+o+"}",this._options.queries[n][o])}this._element.src=i,delete this._options.queries[n].file,e=void 0},this),300)},_onLoad:function(){this._options.onLoad.call(this)}},s});
Ink.createModule("Ink.UI.SmoothScroller","1",["Ink.Dom.Event_1","Ink.Dom.Selector_1","Ink.Dom.Loaded_1"],function(e,t,n){"use strict";var r=window.requestAnimationFrame||function(e){return setTimeout(e,10)},i=window.cancelAnimationFrame||function(e){clearTimeout(e)},o={speed:10,getTop:function(e){return Math.round(o.scrollTop()+e.getBoundingClientRect().top)},scrollTop:function(){var e=document.body,t=document.documentElement;return e&&e.scrollTop?e.scrollTop:t&&t.scrollTop?t.scrollTop:window.pageYOffset?window.pageYOffset:0},add:function(t,n,r){e.observe(t,n,r)},end:function(t){e.stopDefault(t)},scroll:function(e){var t=o.scrollTop();t+=e>t?Math.ceil((e-t)/o.speed):(e-t)/o.speed,window.scrollTo(0,t),i(o.interval),t!==e&&o.offsetTop!==t?o.interval=r(Ink.bindMethod(o,"scroll",e),document.body):o.onDone(),o.offsetTop=t},init:function(e){n.run(Ink.bindMethod(o,"render",e))},render:function(n){for(var r=t.select(n||"a.scrollableLink,a.ink-smooth-scroll"),i=0;i<r.length;i++){var s=r[i];!s.href||-1===s.href.indexOf("#")||s.pathname!==location.pathname&&"/"+s.pathname!==location.pathname||e.observe(s,"click",Ink.bindEvent(o.onClick,this,s))}},onClick:function(e,n){if(o.end(e),null!==n&&null!==n.getAttribute("href")){var r=n.href.indexOf("#");if(-1===r)return;var i=n.href.substr(r+1),s="ul > li.active > "+a,a='a[name="'+i+'"],#'+i,l=t.select(a)[0],u=t.select(s)[0];u=u&&u.parentNode,"undefined"!=typeof l&&(-1===n.parentNode.className.indexOf("active")&&(u&&(u.className=u.className.replace(/(^|\s+)active($|\s+)/g,"")),n.parentNode.className+=" active"),o.hash=i,o.scroll(o.getTop(l)))}},onDone:function(){window.location.hash=o.hash}};return o});
Ink.createModule("Ink.UI.SortableList","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1"],function(e,t,n,r,i,o){"use strict";var s=function(t,n){if(this._element=e.elOrSelector(t,"1st argument"),!e.isDOMElement(t)&&"string"!=typeof t)throw"[Ink.UI.SortableList] :: Invalid selector";if("string"==typeof t){if(this._element=Ink.Dom.Selector.select(t),this._element.length<1)throw"[Ink.UI.SortableList] :: Selector has returned no elements";this._element=this._element[0]}else this._element=t;if(this._options=Ink.extendObj({dragObject:"li"},Ink.Dom.Element.data(this._element)),this._options=Ink.extendObj(this._options,n||{}),this._handlers={down:Ink.bindEvent(this._onDown,this),move:Ink.bindEvent(this._onMove,this),up:Ink.bindEvent(this._onUp,this)},this._model=[],this._index=void 0,this._isMoving=!1,this._options.model instanceof Array)this._model=this._options.model,this._createdFrom="JSON";else{if("ul"!==this._element.nodeName.toLowerCase())throw new TypeError("You must pass a selector expression/DOM element as 1st option or provide a model on 2nd argument!");this._createdFrom="DOM"}if(this._dragTriggers=i.select(this._options.dragObject,this._element),!this._dragTriggers)throw"[Ink.UI.SortableList] :: Drag object not found";this._init()};return s.prototype={_init:function(){"DOM"===this._createdFrom&&(this._extractModelFromDOM(),this._createdFrom="JSON");var n="ontouchstart"in document.documentElement;this._down=n?"touchstart":"mousedown",this._move=n?"touchmove":"mousemove",this._up=n?"touchend":"mouseup";var r=document.body;t.observe(r,this._move,this._handlers.move),t.observe(r,this._up,this._handlers.up),this._observe(),e.registerInstance(this,this._element,"sortableList")},_observe:function(){t.observe(this._element,this._down,this._handlers.down)},_extractModelFromDOM:function(){this._model=[];var e=this,t=i.select("> li",this._element);o.each(t,function(t){var n=t.innerHTML;e._model.push(n)})},_generateMarkup:function(){var e=document.createElement("ul");e.className="unstyled ink-sortable-list";var t=this;return o.each(this._model,function(n,r){var i=document.createElement("li");r===t._index&&(i.className="drag"),i.innerHTML=[n].join(""),e.appendChild(i)}),e},_getY:function(e){return 0===e.type.indexOf("touch")?e.changedTouches[0].pageY:"number"==typeof e.pageY?e.pageY:e.clientY},_refresh:function(t){var n=this._generateMarkup();this._element.parentNode.replaceChild(n,this._element),this._element=n,e.restoreIdAndClasses(this._element,this),this._dragTriggers=i.select(this._options.dragObject,this._element),t||this._observe()},_onDown:function(n){if(!this._isMoving){var r=t.element(n);if(!o.inArray(r,this._dragTriggers)){for(;!o.inArray(r,this._dragTriggers)&&"body"!==r.nodeName.toLowerCase();)r=r.parentNode;if("body"===r.nodeName.toLowerCase())return}t.stop(n);var i;if("li"!==r.nodeName.toLowerCase())for(;"li"!==r.nodeName.toLowerCase()&&"body"!==r.nodeName.toLowerCase();)r=r.parentNode;return i=r,this._index=e.childIndex(i),this._height=i.offsetHeight,this._startY=this._getY(n),this._isMoving=!0,document.body.style.cursor="move",this._refresh(!1),!1}},_onMove:function(e){if(this._isMoving){t.stop(e);var n=this._getY(e),r=n-this._startY,i=r>0?1:-1,o=i*Math.floor(Math.abs(r)/this._height);if(0!==o&&(o/=Math.abs(o),!(-1===o&&0===this._index||1===o&&this._index===this._model.length-1))){var s=o>0?this._index:this._index+o,a=0>o?this._index:this._index+o;this._model.splice(s,2,this._model[a],this._model[s]),this._index+=o,this._startY=n,this._refresh(!1)}}},_onUp:function(e){this._isMoving&&(t.stop(e),this._index=void 0,this._isMoving=!1,document.body.style.cursor="",this._refresh())},getModel:function(){return this._model.slice()},destroy:e.destroyComponent},s});
Ink.createModule("Ink.UI.Spy","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1"],function(e,t,n,r,i,o){"use strict";var s=function(t,n){this._rootElement=e.elOrSelector(t,"1st argument"),this._options=Ink.extendObj({target:void 0},r.data(this._rootElement)),this._options=Ink.extendObj(this._options,n||{}),this._options.target=e.elOrSelector(this._options.target,"Target"),this._scrollTimeout=null,this._init()};return s.prototype={_elements:[],_init:function(){t.observe(document,"scroll",Ink.bindEvent(this._onScroll,this)),this._elements.push(this._rootElement)},_onScroll:function(){var e=r.scrollHeight();if(!(e<this._rootElement.offsetTop)){for(var t=0,s=this._elements.length;s>t;t++)if(this._elements[t].offsetTop<=e&&this._elements[t]!==this._rootElement&&this._elements[t].offsetTop>this._rootElement.offsetTop)return;o.each(i.select("a",this._options.target),Ink.bind(function(e){var t="name"in this._rootElement&&this._rootElement.name?"#"+this._rootElement.name:"#"+this._rootElement.id;e.href.substr(e.href.indexOf("#"))===t?n.addClassName(r.findUpwardsByTag(e,"li"),"active"):n.removeClassName(r.findUpwardsByTag(e,"li"),"active")},this))}}},s});
Ink.createModule("Ink.UI.Sticky","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Element_1"],function(e,t,n){"use strict";var r=function(t,n){this._rootElement=e.elOrSelector(t,"Ink.UI.Sticky_1"),this._options=e.options({offsetBottom:["Integer",0],offsetTop:["Integer",0],topElement:["Element",null],bottomElement:["Element",null],activateInLayouts:["String","medium,large"]},n||{},this._rootElement),this._options.activateInLayouts=this._options.activateInLayouts.toString();var r=window.getComputedStyle?window.getComputedStyle(this._rootElement,null):this._rootElement.currentStyle;this._dims={height:r.height,width:r.width},this._init()};return r.prototype={_init:function(){t.observe(document,"scroll",Ink.bindEvent(t.throttle(this._onScroll,100),this)),t.observe(window,"resize",Ink.bindEvent(t.throttle(this._onResize,100),this)),this._calculateOriginalSizes(),this._calculateOffsets()},_isDisabledInLayout:function(){return-1===this._options.activateInLayouts.indexOf(e.currentLayout())},_onScroll:function(){var e=n.scrollHeight(),t=this._isDisabledInLayout()||e<=this._options.originalTop-this._options.originalOffsetTop;t?this._unstick():document.body.scrollHeight-(e+parseInt(this._dims.height,10))>=this._options.offsetBottom?this._stickTo("screen"):this._stickTo("bottom")},_stickTo:function(e){var t=n.scrollHeight(),r=this._rootElement.style;if(r.position="fixed",r.left=this._options.originalLeft+"px",r.width=this._options.originalWidth+"px","screen"===e)r.bottom="auto",r.top=this._options.originalOffsetTop+"px";else if("bottom"===e){var i=document.body.scrollHeight-(document.documentElement.clientHeight+t);r.bottom=this._options.offsetBottom-i+"px",r.top="auto"}},_unstick:function(){this._rootElement.style.position="static",this._rootElement.style.width=null},_onResize:function(){this._rootElement.removeAttribute("style"),this._calculateOriginalSizes(),this._calculateOffsets()},_calculateOffsets:function(){if(this._options.topElement){var e=n.elementHeight(this._options.topElement),t=n.elementTop(this._options.topElement);this._options.offsetTop=e+t+parseInt(this._options.originalOffsetTop,10)}if(this._options.bottomElement){var r=n.elementHeight(this._options.bottomElement);this._options.offsetBottom=r+this._options.originalOffsetBottom}this._onScroll()},_calculateOriginalSizes:function(){"undefined"==typeof this._options.originalOffsetTop&&(this._options.originalOffsetTop=parseInt(this._options.offsetTop,10),this._options.originalOffsetBottom=parseInt(this._options.offsetBottom,10)),this._options.originalTop=parseInt(this._rootElement.offsetTop,10),this._options.originalLeft=parseInt(this._rootElement.offsetLeft,10),this._options.originalWidth=parseInt(this._dims.width,10)||0}},r});
Ink.createModule("Ink.UI.Swipe","1",["Ink.Dom.Event_1","Ink.Dom.Element_1","Ink.UI.Common_1"],function(e,t,n){"use strict";function i(e,i){e=n.elOrSelector(e,"Swipe target"),this._options=Ink.extendObj({onEnd:void 0,onStart:void 0,onMove:void 0,minDist:void 0,maxDist:void 0,minDuration:void 0,maxDuration:void 0,axis:void 0,storeGesture:!1,stopEvents:!0},t.data(e),i||{}),"function"==typeof i&&(this._options.onEnd=i),this._handlers={down:Ink.bindEvent(this._onDown,this),move:Ink.bindEvent(this._onMove,this),up:Ink.bindEvent(this._onUp,this)},this._element=e,this._init()}return i.prototype={version:"0.1",_supported:"ontouchstart"in document.documentElement,_init:function(){var t=document.body;e.observe(t,"touchstart",this._handlers.down),(this._options.storeGesture||this._options.onMove)&&e.observe(t,"touchmove",this._handlers.move),e.observe(t,"touchend",this._handlers.up),this._isOn=!1},_isMeOrParent:function(e,t){if(e){do{if(e===t)return!0;e=e.parentNode}while(e);return!1}},_pushGesture:function(e,t){this._options.storeGesture&&(this._gesture.push(e),this._time.push(t))},_onDown:function(t){1===t.changedTouches.length&&this._isMeOrParent(t.target,this._element)&&(this._options.stopEvents===!0&&e.stop(t),t=t.changedTouches[0],this._isOn=!0,this._target=t.target,this._t0=+new Date,this._p0=[t.pageX,t.pageY],this._options.storeGesture&&(this._gesture=[],this._time=[]),this._pushGesture(this._p0,0),this._options.onStart&&this._options.onStart({event:t,element:this._element,instance:this,position:this._p0,dt:0}))},_onMove:function(t){if(this._isOn&&1===t.changedTouches.length){this._options.stopEvents===!0&&e.stop(t),t=t.changedTouches[0];var n=+new Date,i=n-this._t0,r=[t.pageX,t.pageY];this._pushGesture(r,i),this._options.onMove&&this._options.onMove({event:t,element:this._element,instance:this,position:r,dt:i})}},_onUp:function(t){if(this._isOn&&1===t.changedTouches.length){this._options.stopEvents===!0&&e.stop(t),t=t.changedTouches[0],this._isOn=!1;var n=+new Date,i=[t.pageX,t.pageY],r=n-this._t0,o=[i[0]-this._p0[0],i[1]-this._p0[1]],s=Math.sqrt(o[0]*o[0]+o[1]*o[1]),a=Math.abs(o[0])>Math.abs(o[1])?"x":"y",l=this._options;l.minDist&&s<l.minDist||l.maxDist&&s>l.maxDist||l.minDuration&&r<l.minDuration||l.maxDuration&&r>l.maxDuration||l.axis&&a!==l.axis||this._options.onEnd&&this._options.onEnd({event:t,element:this._element,instance:this,gesture:this._gesture,time:this._time,axis:a,overallMovement:o,overallTime:r})}}},i});
Ink.createModule("Ink.UI.Table","1",["Ink.Util.Url_1","Ink.UI.Pagination_1","Ink.Net.Ajax_1","Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1","Ink.Util.String_1","Ink.Util.Json_1"],function(e,t,n,i,r,o,s,a,l,u,c){"use strict";function d(e){return!isNaN(e)&&m.test(e)?parseInt(e,10):isNaN(e)?e:parseFloat(e)}function h(e,t,n){var i=s.textContent(a.select("td",t)[e]),r=s.textContent(a.select("td",n)[e]);return i=d(i),r=d(r),i===r?0:i>r?1:-1}function f(e){if("undefined"!=typeof Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function p(e){return e}var m=/\d/g,g=function(e,t){if(this._rootElement=i.elOrSelector(e,"Ink.UI.Table :"),"table"!==this._rootElement.nodeName.toLowerCase())throw"[Ink.UI.Table] :: The element is not a table";this._options=i.options({pageSize:["Integer",null],endpoint:["String",null],createEndpointUrl:["Function",null],getDataFromEndPoint:["Function",null],processJSONRows:["Function",p],processJSONRow:["Function",p],processJSONField:["Function",p],processJSONHeaders:["Function",function(e){return e.fields}],processJSONTotalRows:["Function",function(e){return e.length||e.totalRows}],pagination:["Element",null],allowResetSorting:["Boolean",!1],visibleFields:["String",null],tdClassNames:["Object",{}],paginationOptions:["Object",null]},t||{},this._rootElement),this._markupMode=!this._options.endpoint,this._options.visibleFields&&(this._options.visibleFields=this._options.visibleFields.split(/[, ]+/g)),this._thead=this._rootElement.tHead||this._rootElement.createTHead(),this._headers=a.select("th",this._thead),this._handlers={thClick:null},this._originalFields=[],this._sortableFields={},this._originalData=this._data=[],this._pagination=null,this._totalRows=0,this._handlers.thClick=r.observeDelegated(this._rootElement,"click",'thead th[data-sortable="true"]',Ink.bindMethod(this,"_onThClick")),this._init()};return g.prototype={_init:function(){this._markupMode?(this._resetSortOrder(),this._addHeadersClasses(),this._data=a.select("tbody tr",this._rootElement),this._originalData=this._data.slice(0),this._totalRows=this._data.length,this._setPagination()):this._getData()},_addHeadersClasses:function(){for(var e,t=0,n=this._headers.length;n>t;t++)e=s.textContent(this._headers[t]),this._options.tdClassNames[e]&&o.addClassName(this._headers[t],this._options.tdClassNames[e])},_onThClick:function(e){var t=r.element(e),n=void 0!==this._options.pageSize;r.stop(e);var o=l.keyValue(t,this._headers,!0),s=o!==!1&&void 0!==this._sortableFields[o];if(s)if(!this._markupMode&&n)this._invertSortOrder(o,!1);else{"desc"===this._sortableFields[o]&&this._options.allowResetSorting?(this._setSortOrderOfColumn(o,null),this._data=this._originalData.slice(0)):this._invertSortOrder(o,!0);var u=a.select("tbody",this._rootElement)[0];i.cleanChildren(u),l.each(this._data,Ink.bindMethod(u,"appendChild")),this._pagination.setCurrent(0),this._paginate(1)}},_invertSortOrder:function(e,t){for(var n="asc"===this._sortableFields[e],i=0,r=this._headers.length;r>i;i++)this._setSortOrderOfColumn(i,null);t&&(this._sort(e),n&&this._data.reverse()),this._setSortOrderOfColumn(e,!n)},_setSortOrderOfColumn:function(e,t){var n=this._headers[e],i="",r="none";t===!0?(i='<i class="icon-caret-up"></i>',r="asc"):t===!1&&(i='<i class="icon-caret-down"></i>',r="desc"),this._sortableFields[e]=r,n.innerHTML=s.textContent(n)+i},_paginate:function(e){if(this._pagination){var t=this._options.pageSize,n=(e-1)*t,i=n+t;l.each(this._data,function(e,t){t>=n&&i>t?o.removeClassName(e,"hide-all"):o.addClassName(e,"hide-all")})}},_registerFieldNames:function(e){this._originalFields=[],l.forEach(e,Ink.bind(function(e){this._fieldIsVisible(e)&&this._originalFields.push(e)},this))},_fieldIsVisible:function(e){return!this._options.visibleFields||-1!==this._options.visibleFields.indexOf(e)},_sort:function(e){this._data.sort(Ink.bind(h,!1,e))},_createHeadersFromJson:function(e){if(this._registerFieldNames(f(e)),!this._thead.children.length)for(var t,n=this._thead.insertRow(0),i=0,r=e.length;r>i;i++)this._fieldIsVisible(e[i])&&(t=s.create("th"),t=this._createSingleHeaderFromJson(e[i],t),n.appendChild(t),this._headers.push(t))},_createSingleHeaderFromJson:function(e,t){return e.sortable&&t.setAttribute("data-sortable","true"),e.label&&s.setTextContent(t,e.label),t},_resetSortOrder:function(){for(var e=0,t=this._headers.length;t>e;e++){var n=s.data(this._headers[e]);n.sortable&&"true"===n.sortable.toString()&&(this._sortableFields[e]="none")}},_createRowsFromJSON:function(e){var t=a.select("tbody",this._rootElement)[0];t?s.setHTML(t,""):(t=document.createElement("tbody"),this._rootElement.appendChild(t)),this._data=[];var n;for(var i in e)e.hasOwnProperty(i)&&(n=this._options.processJSONRow(e[i]),this._createSingleRowFromJson(t,n,i));this._originalData=this._data.slice(0)},_createSingleRowFromJson:function(e,t,n){var i=document.createElement("tr");e.appendChild(i);for(var r in t)t.hasOwnProperty(r)&&this._createFieldFromJson(i,t[r],r,n);this._data.push(i)},_createFieldFromJson:function(e,t,n,i){if(this._fieldIsVisible(n)){var r,s=this._options.processJSONField[n]||this._options.processJSONField;r="function"==typeof s?s(t,n,i):t;var a=this._elOrFieldData(r),l=this._options.tdClassNames[n];l&&o.addClassName(a,l),e.appendChild(a)}},_elOrFieldData:function(e){if(i.isDOMElement(e))return e;var t="string"==typeof e,n="number"==typeof e,r=s.create("td");if(t&&/^\s*?</.test(e))s.setHTML(r,e);else{if(!t&&!n)throw new Error("Ink.UI.Table Unknown result from processJSONField: "+e);s.setTextContent(r,e)}return r},setEndpoint:function(e,t){this._markupMode||(this._options.endpoint=e,this._pagination.setCurrent(t?parseInt(t,10):0))},_setPagination:function(){if(null!=this._options.pageSize){var e=this._options.pagination;if(e instanceof t)return this._pagination=e,void 0;e||(e=s.create("nav",{className:"ink-navigation",insertAfter:this._rootElement}),s.create("ul",{className:"pagination",insertBottom:e}));var n=Ink.extendObj({totalItemCount:this._totalRows,itemsPerPage:this._options.pageSize,onChange:Ink.bind(function(e,t){this._paginate(t+1)},this)},this._options.paginationOptions||{});this._pagination=new t(e,n),this._paginate(1)}},_getData:function(){var e=this._getSortOrder()||null,t=null;this._pagination&&(t={size:this._options.pageSize,page:this._pagination.getCurrent()+1}),this._getDataViaAjax(this._getUrl(e,t))},_getSortOrder:function(){var e;for(e in this._sortableFields)if(this._sortableFields.hasOwnProperty(e)&&"none"!==this._sortableFields[e])break;return e?{field:this._originalFields[e],order:this._sortableFields[e]}:null},_getUrl:function(t,n){var i=this._options.createEndpointUrl||function(t,n,i){return t=e.parseUrl(t),t.query=t.query||{},n&&(t.query.sortOrder=n.order,t.query.sortField=n.field),i&&(t.query.rows_per_page=i.size,t.query.page=i.page),e.format(t)},r=i(this._options.endpoint,t,n);if("string"!=typeof r)throw new TypeError("Ink.UI.Table_1: createEndpointUrl did not return a string!");return r},_getDataViaAjax:function(e){var t=Ink.bind(function(e){this._onAjaxSuccess(e)},this);this._options.getDataFromEndpoint?this._options.getDataFromEndpoint(e,t):new n(e,{method:"GET",contentType:"application/json",sanitizeJSON:!0,onSuccess:Ink.bind(function(e){200===e.status&&t(c.parse(e.responseText))},this)})},_onAjaxSuccess:function(e){var t=null!=this._options.pageSize,n=this._options.processJSONRows(e);if(this._headers=a.select("th",this._thead),0===this._headers.length){var i=this._options.processJSONHeaders(e);if(!i||!i.length||!i[0])throw new Error("Ink.UI.Table: processJSONHeaders option must return an array of objects!");this._createHeadersFromJson(i),this._resetSortOrder(),this._addHeadersClasses()}this._createRowsFromJSON(n),this._totalRows=this._rowLength=n.length,t&&(this._totalRows=this._options.processJSONTotalRows(e),this._setPagination())}},g});
Ink.createModule("Ink.UI.Tabs","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1"],function(e,t,n,i,r,o){"use strict";var s=function(t,n){if(e.isDOMElement(t))this._element=t;else{if(t=r.select(t),0===t.length)throw new TypeError("1st argument must either be a DOM Element or a selector expression!");this._element=t[0]}this._options=Ink.extendObj({preventUrlChange:!1,active:void 0,disabled:[],onBeforeChange:void 0,onChange:void 0,triggerEventsOnLoad:!0},n||{},i.data(t)),this._handlers={tabClicked:Ink.bindEvent(this._onTabClicked,this),disabledTabClicked:Ink.bindEvent(this._onDisabledTabClicked,this),resize:Ink.bindEvent(this._onResize,this)},this._init()};return s.prototype={_init:function(){this._menu=r.select(".tabs-nav",this._element)[0],this._menuTabs=this._getChildElements(this._menu),this._contentTabs=r.select(".tabs-content",this._element),this._initializeDom(),this._observe(),this._setFirstActive(),this._changeTab(this._activeMenuLink,this._options.triggerEventsOnLoad),this._handlers.resize(),e.registerInstance(this,this._element,"tabs")},_initializeDom:function(){for(var e=0;e<this._contentTabs.length;e++)n.hide(this._contentTabs[e])},_observe:function(){o.each(this._menuTabs,Ink.bind(function(e){var t=r.select("a",e)[0];o.inArray(t.getAttribute("href"),this._options.disabled)?this.disable(t):this.enable(t)},this)),t.observe(window,"resize",this._handlers.resize)},_setFirstActive:function(){var e=window.location.hash;this._activeContentTab=r.select(e,this._element)[0]||r.select(this._hashify(this._options.active),this._element)[0]||r.select(".tabs-content",this._element)[0],this._activeMenuLink=this._findLinkByHref(this._activeContentTab.getAttribute("id")),this._activeMenuTab=this._activeMenuLink.parentNode},_changeTab:function(e,t){t&&"undefined"!=typeof this._options.onBeforeChange&&this._options.onBeforeChange(this);var i=e.getAttribute("href");n.removeClassName(this._activeMenuTab,"active"),n.removeClassName(this._activeContentTab,"active"),n.addClassName(this._activeContentTab,"hide-all"),this._activeMenuLink=e,this._activeMenuTab=this._activeMenuLink.parentNode,this._activeContentTab=r.select(i.substr(i.indexOf("#")),this._element)[0],n.addClassName(this._activeMenuTab,"active"),n.addClassName(this._activeContentTab,"active"),n.removeClassName(this._activeContentTab,"hide-all"),n.show(this._activeContentTab),t&&"undefined"!=typeof this._options.onChange&&this._options.onChange(this)},_onTabClicked:function(e){t.stop(e);var n=t.findElement(e,"A");"a"===n.nodeName.toLowerCase()&&("true"!==this._options.preventUrlChange.toString()&&(window.location.hash=n.getAttribute("href").substr(n.getAttribute("href").indexOf("#"))),n!==this._activeMenuLink&&this.changeTab(n))},_onDisabledTabClicked:function(e){t.stop(e)},_onResize:function(){var t=e.currentLayout();t!==this._lastLayout&&(t===e.Layouts.SMALL||t===e.Layouts.MEDIUM?(n.removeClassName(this._menu,"menu"),n.removeClassName(this._menu,"horizontal")):(n.addClassName(this._menu,"menu"),n.addClassName(this._menu,"horizontal")),this._lastLayout=t)},_hashify:function(e){return e?0===e.indexOf("#")?e:"#"+e:""},_findLinkByHref:function(e){e=this._hashify(e);var t;return o.each(this._menuTabs,Ink.bind(function(n){var i=r.select("a",n)[0];-1!==i.getAttribute("href").indexOf("#")&&i.getAttribute("href").substr(i.getAttribute("href").indexOf("#"))===e&&(t=i)},this)),t},_getChildElements:function(e){for(var t=[],n=e.children,i=0;i<n.length;i++)1===n[i].nodeType&&t.push(n[i]);return t},changeTab:function(e){var t=1===e.nodeType?e:this._findLinkByHref(this._hashify(e));t&&!n.hasClassName(t,"ink-disabled")&&this._changeTab(t,!0)},disable:function(e){var i=1===e.nodeType?e:this._findLinkByHref(this._hashify(e));i&&(t.stopObserving(i,"click",this._handlers.tabClicked),t.observe(i,"click",this._handlers.disabledTabClicked),n.addClassName(i,"ink-disabled"))},enable:function(e){var i=1===e.nodeType?e:this._findLinkByHref(this._hashify(e));i&&(t.stopObserving(i,"click",this._handlers.disabledTabClicked),t.observe(i,"click",this._handlers.tabClicked),n.removeClassName(i,"ink-disabled"))},activeTab:function(){return this._activeContentTab.getAttribute("id")},activeMenuTab:function(){return this._activeMenuTab},activeMenuLink:function(){return this._activeMenuLink},activeContentTab:function(){return this._activeContentTab},destroy:e.destroyComponent},s});
Ink.createModule("Ink.UI.TagField","1",["Ink.Dom.Element_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Browser_1","Ink.UI.Droppable_1","Ink.Util.Array_1","Ink.Dom.Selector_1","Ink.UI.Common_1"],function(e,t,n,i,o,r,s,a){"use strict";function l(e,t){this.init(e,t)}var u=13,c=8,d=function(e){return!!e};return l.prototype={init:function(i,o){i=this._element=a.elOrSelector(i,"Ink.UI.TagField");var s=this._options=a.options("Ink.UI.TagField",{tags:["String",[]],tagQuery:["Object",null],tagQueryAsync:["Object",null],allowRepeated:["Boolean",!1],maxTags:["Integer",-1],outSeparator:["String",","],separator:["String",/[,; ]+/g],autoSplit:["Boolean",!0]},o||{},this._element);"string"==typeof s.separator&&(s.separator=new RegExp(s.separator,"g")),"string"==typeof s.tags&&(s.tags=this._readInput(s.tags)),n.addClassName(this._element,"hide-all"),this._viewElm=e.create("div",{className:"ink-tagfield",insertAfter:this._element}),this._input=e.create("input",{type:"text",className:"new-tag-input",insertBottom:this._viewElm});var l=[].concat(s.tags,this._tagsFromMarkup(this._element));this._tags=[],r.each(l,Ink.bindMethod(this,"_addTag")),t.observe(this._input,"keyup",Ink.bindEvent(this._onKeyUp,this)),t.observe(this._input,"change",Ink.bindEvent(this._onKeyUp,this)),t.observe(this._input,"keydown",Ink.bindEvent(this._onKeyDown,this)),t.observe(this._input,"blur",Ink.bindEvent(this._onBlur,this)),t.observe(this._viewElm,"click",Ink.bindEvent(this._refocus,this))},destroy:function(){e.remove(this._viewElm),n.removeClassName(this._element,"hide-all")},_tagsFromMarkup:function(t){var n=t.tagName.toLowerCase();if("input"===n)return this._readInput(t.value);if("select"===n)return r.map(t.getElementsByTagName("option"),function(t){return e.textContent(t)});throw new Error("Cannot read tags from a "+n+" tag. Unknown tag")},_tagsToMarkup:function(t,n){var i=n.tagName.toLowerCase();if("input"===i)this._options.separator&&(n.value=t.join(this._options.outSeparator));else{if("select"!==i)throw new Error("TagField: Cannot read tags from a "+i+" tag. Unknown tag");n.innerHTML="",r.each(t,function(t){var i=e.create("option",{selected:"selected"});e.setTextContent(i,t),n.appendChild(i)})}},_addTag:function(n){if(!(-1!==this._options.maxTags&&this._tags.length>=this._options.maxTags)){if(!this._options.allowRepeated&&r.inArray(n,this._tags,n)||!n)return!1;var i=e.create("span",{className:"ink-tag",setTextContent:n+" "}),o=e.create("i",{className:"remove icon-remove",insertBottom:i});t.observe(o,"click",Ink.bindEvent(this._removeTag,this,null));var s=document.createTextNode(" ");this._tags.push(n),this._viewElm.insertBefore(i,this._input),this._viewElm.insertBefore(s,this._input),this._tagsToMarkup(this._tags,this._element)}},_readInput:function(e){return this._options.separator?r.filter(e.split(this._options.separator),d):[e]},_onKeyUp:function(){if(this._options.autoSplit){var e=this._input.value.split(this._options.separator);if(!(e.length<=1)){var t=e[e.length-1];e=e.splice(0,e.length-1),e=r.filter(e,d),r.each(e,Ink.bind(this._addTag,this)),this._input.value=t}}},_onKeyDown:function(e){return e.which===u?this._onEnterKeyDown(e):e.which===c?this._onBackspaceKeyDown():(this._removeConfirm&&this._unsetRemovingVisual(this._tags.length-1),void 0)},_onBackspaceKeyDown:function(){this._input.value||(this._removeConfirm?(this._unsetRemovingVisual(this._tags.length-1),this._removeTag(this._tags.length-1),this._removeConfirm=null):this._setRemovingVisual(this._tags.length-1))},_onEnterKeyDown:function(e){var n=this._input.value;n&&(this._addTag(n),this._input.value=""),t.stopDefault(e)},_onBlur:function(){this._addTag(this._input.value),this._input.value=""},_setRemovingVisual:function(e){var i=this._viewElm.children[e];n.addClassName(i,"tag-deleting"),this._removeRemovingVisualTimeout=setTimeout(Ink.bindMethod(this,"_unsetRemovingVisual",e),4e3),t.observe(this._input,"blur",Ink.bindMethod(this,"_unsetRemovingVisual",e)),this._removeConfirm=!0},_unsetRemovingVisual:function(e){var t=this._viewElm.children[e];t&&(n.removeClassName(t,"tag-deleting"),clearTimeout(this._removeRemovingVisualTimeout)),this._removeConfirm=null},_removeTag:function(n){var i;if("object"==typeof n){var o=t.element(n).parentNode;i=e.parentIndexOf(this._viewElm,o)}else"number"==typeof n&&(i=n);this._tags=r.remove(this._tags,i,1),e.remove(this._viewElm.children[i]),this._tagsToMarkup(this._tags,this._element)},_refocus:function(e){return this._input.focus(),t.stop(e),!1}},l});
Ink.createModule("Ink.UI.Toggle","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1"],function(e,t,n,i,o,r){"use strict";var s=function(t,o){if(this._rootElement=e.elOrSelector(t,"[Ink.UI.Toggle root element]:"),this._options=Ink.extendObj({target:void 0,triggerEvent:"click",closeOnClick:!0,isAccordion:!1,initialState:null,classNameOn:"show-all",classNameOff:"hide-all",togglesDisplay:null,closeOnInsideClick:"a[href]",onChangeState:null},o||{},i.data(this._rootElement)),this._targets=e.elsOrSelector(this._options.target,"Ink.UI.Toggle target option"),this._options.closeOnClick="true"===this._options.closeOnClick.toString(),this._options.initialState=null!==this._options.initialState?"true"===this._options.initialState.toString():"none"!==n.getStyle(this._targets[0],"display"),"show-all"!==this._options.classNameOn||"hide-all"!==this._options.classNameOff)for(var r=0,s=this._targets.length;s>r;r++)n.removeClassName(this._targets[r],"show-all"),n.removeClassName(this._targets[r],"hide-all");this._init()};return s.prototype={_init:function(){if(this._accordion=n.hasClassName(this._rootElement.parentNode,"accordion")||n.hasClassName(this._targets[0].parentNode,"accordion"),this._firstTime=!0,this._bindEvents(),null!==this._options.initialState)this.setState(this._options.initialState,!0);else{var e="none"!==n.getStyle(this._targets[0],"display");this.setState(e,!0)}for(var t=0,i=this._targets.length;i>t;t++)this._targets[t].style.display&&(this._targets[t].style.display="")},_bindEvents:function(){if(this._options.triggerEvent&&t.observe(this._rootElement,this._options.triggerEvent,Ink.bind(this._onTriggerEvent,this)),this._options.closeOnClick&&t.observe(document,"click",Ink.bind(this._onOutsideClick,this)),this._options.closeOnInsideClick){var e=this._options.closeOnInsideClick;"true"===e.toString()&&(e="*"),t.observeMulti(this._targets,"click",Ink.bind(function(n){i.findUpwardsBySelector(t.element(n),e)&&this.setState(!1,!0)},this))}},_onTriggerEvent:function(e){var n=t.element(e),o=r.some(this._targets,function(e){return e===n||i.isAncestorOf(e,n)});if(!o){this._accordion&&this._updateAccordion();var s=this.getState();this.setState(!s,!0),!s&&this._firstTime&&(this._firstTime=!1),t.stopDefault(e)}},_updateAccordion:function(){var e,t;t=n.hasClassName(this._targets[0].parentNode,"accordion")?this._targets[0].parentNode:this._targets[0].parentNode.parentNode,e=o.select(".toggle, .ink-toggle",t);for(var r=0;r<e.length;r+=1){var s=i.data(e[r]),a=o.select(s.target,t);a.length>0&&a[0]!==this._targets[0]&&(a[0].style.display="none")}},_onOutsideClick:function(e){var n,o=t.element(e),s=r.some(this._targets,function(e){return i.isAncestorOf(e,o)||e===o});if(this._rootElement!==o&&!i.isAncestorOf(this._rootElement,o)&&!s){if((n=Ink.ss(".ink-shade")).length)for(var a=n.length,l=0;a>l;l++)if(i.isAncestorOf(n[l],o)&&i.isAncestorOf(n[l],this._rootElement))return;this.setState(!1,!0)}},setState:function(e,t){if(e!==this.getState()){if(t&&"function"==typeof this._options.onChangeState){var i=this._options.onChangeState(e);if(i===!1)return!1}for(var o=0,r=this._targets.length;r>o;o++)n.addRemoveClassName(this._targets[o],this._options.classNameOn,e),n.addRemoveClassName(this._targets[o],this._options.classNameOff,!e);n.addRemoveClassName(this._rootElement,"active",e)}},getState:function(){return n.hasClassName(this._rootElement,"active")}},s});
Ink.createModule("Ink.UI.Pagination","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1"],function(e,t,n,i,o){"use strict";var r=function(e,t){var n=document.createElement("a");return n.setAttribute("href","#"),void 0!==t&&n.setAttribute("data-index",t),n.innerHTML=e,n},s=function(t,n){if(this._element=e.elOrSelector(t,"Ink.UI.Pagination element"),this._options=e.options("Ink.UI.Pagination_1",{size:["Integer",null],totalItemCount:["Integer",null],itemsPerPage:["Integer",null],maxSize:["Integer",null],start:["Integer",1],firstLabel:["String","First"],lastLabel:["String","Last"],previousLabel:["String","Previous"],nextLabel:["String","Next"],onChange:["Function",void 0],hashParameter:["String","page"],numberFormatter:["Function",function(e){return e+1}]},n||{},this._element),this._options.previousPageLabel||(this._options.previousPageLabel="Previous "+this._options.maxSize),this._options.nextPageLabel||(this._options.nextPageLabel="Next "+this._options.maxSize),this._handlers={click:Ink.bindEvent(this._onClick,this)},e.isInteger(this._options.totalItemCount)&&e.isInteger(this._options.itemsPerPage))this._size=Math.ceil(this._options.totalItemCount/this._options.itemsPerPage);else{if(!e.isInteger(this._options.size))throw new TypeError("Ink.UI.Pagination: Please supply a size option or totalItemCount and itemsPerPage options.");this._size=this._options.size}if(!e.isInteger(this._options.start)&&this._options.start>0&&this._options.start<=this._size)throw new TypeError("start option is a required integer between 1 and size!");if(this._options.maxSize&&!e.isInteger(this._options.maxSize)&&this._options.maxSize>0)throw new TypeError("maxSize option is a positive integer!");if(this._size<0)throw new RangeError("size option must be equal or more than 0!");this.setOnChange(this._options.onChange),this._current=this._options.start-1,this._itemLiEls=[],this._init()};return s.prototype={_init:function(){this._generateMarkup(this._element),n.hasClassName(Ink.s("ul",this._element),"dotted")&&(this._options.numberFormatter=function(){return'<i class="icon-circle"></i>'}),this._updateItems(),this._observe(),e.registerInstance(this,this._element,"pagination")},_observe:function(){t.observeDelegated(this._element,"click",".pagination > li",this._handlers.click)},_updateItems:function(){var e,t,i,o=this._itemLiEls,s=this._size===o.length;if(s)for(e=0,t=this._size;t>e;++e)n.setClassName(o[e],"active",e===this._current);else{for(e=o.length-1;e>=0;--e)this._ulEl.removeChild(o[e]);for(o=[],e=0,t=this._size;t>e;++e)i=document.createElement("li"),i.appendChild(r(this._options.numberFormatter(e),e)),n.setClassName(i,"active",e===this._current),this._ulEl.insertBefore(i,this._nextEl),o.push(i);this._itemLiEls=o}if(this._options.maxSize){var a=Math.floor(this._current/this._options.maxSize),l=this._options.maxSize*a,u=l+this._options.maxSize-1;for(e=0,t=this._size;t>e;++e)i=o[e],n.setClassName(i,"hide-all",l>e||e>u);this._pageStart=l,this._pageEnd=u,this._page=a,n.setClassName(this._prevPageEl,"disabled",!this.hasPreviousPage()),n.setClassName(this._nextPageEl,"disabled",!this.hasNextPage()),n.setClassName(this._firstEl,"disabled",this.isFirst()),n.setClassName(this._lastEl,"disabled",this.isLast())}n.setClassName(this._prevEl,"disabled",!this.hasPrevious()),n.setClassName(this._nextEl,"disabled",!this.hasNext())},_generateMarkup:function(e){n.addClassName(e,"ink-navigation");var t,i,s=!1;(t=o.select("ul.pagination",e)).length<1?(t=document.createElement("ul"),n.addClassName(t,"pagination")):(s=!0,t=t[0]),this._options.maxSize&&(i=document.createElement("li"),i.appendChild(r(this._options.firstLabel)),this._firstEl=i,n.addClassName(i,"first"),t.appendChild(i),i=document.createElement("li"),i.appendChild(r(this._options.previousPageLabel)),this._prevPageEl=i,n.addClassName(i,"previousPage"),t.appendChild(i)),i=document.createElement("li"),i.appendChild(r(this._options.previousLabel)),this._prevEl=i,n.addClassName(i,"previous"),t.appendChild(i),i=document.createElement("li"),i.appendChild(r(this._options.nextLabel)),this._nextEl=i,n.addClassName(i,"next"),t.appendChild(i),this._options.maxSize&&(i=document.createElement("li"),i.appendChild(r(this._options.nextPageLabel)),this._nextPageEl=i,n.addClassName(i,"nextPage"),t.appendChild(i),i=document.createElement("li"),i.appendChild(r(this._options.lastLabel)),this._lastEl=i,n.addClassName(i,"last"),t.appendChild(i)),s||e.appendChild(t),this._ulEl=t},_onClick:function(e){t.stop(e);var i=t.element(e);if(!n.hasClassName(i,"active")&&!n.hasClassName(i,"disabled")){var o=n.hasClassName(i,"previous"),r=n.hasClassName(i,"next"),s=n.hasClassName(i,"previousPage"),a=n.hasClassName(i,"nextPage"),l=n.hasClassName(i,"first"),u=n.hasClassName(i,"last");if(l)this.setCurrent(0);else if(u)this.setCurrent(this._size-1);else if(s||a)this.setCurrent((s?-1:1)*this._options.maxSize,!0);else if(o||r)this.setCurrent(o?-1:1,!0);else{var c=Ink.s("[data-index]",i),h=parseInt(c.getAttribute("data-index"),10);this.setCurrent(h)}}},setOnChange:function(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("onChange option must be a function!");this._onChange=e},setSize:function(t){if(!e.isInteger(t))throw new TypeError("1st argument must be an integer number!");this._size=t,this._updateItems(),this._current=0},setSizeInItems:function(e,t){var n=Math.ceil(e/t);this.setSize(n)},setCurrent:function(t,n){if(!e.isInteger(t))throw new TypeError("1st argument must be an integer number!");n&&(t+=this._current),t>this._size-1&&(t=this._size-1),0>t&&(t=0),this._current=t,this._updateItems(),this._onChange&&this._onChange(this,t)},getSize:function(){return this._size},getCurrent:function(){return this._current},isFirst:function(){return 0===this._current},isLast:function(){return this._current===this._size-1},hasPrevious:function(){return this._current>0},hasNext:function(){return this._current<this._size-1},hasPreviousPage:function(){return this._options.maxSize&&this._current>this._options.maxSize-1},hasNextPage:function(){return this._options.maxSize&&this._size-this._current>=this._options.maxSize+1},destroy:e.destroyComponent},s});
Ink.createModule("Ink.UI.TreeView","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1"],function(e,t,n,i,o,r){"use strict";var s=function(t,n){if(!e.isDOMElement(t)&&"string"!=typeof t)throw"[Ink.UI.TreeView] :: Invalid selector";if("string"==typeof t){if(this._element=o.select(t),this._element.length<1)throw"[Ink.UI.TreeView] :: Selector has returned no elements";this._element=this._element[0]}else this._element=t;this._options=Ink.extendObj({node:"li",child:"ul",parentClass:"parent",openClass:"icon-minus-sign",closedClass:"icon-plus-sign",hideClass:"hide-all",iconTag:"i"},i.data(this._element)),this._options=Ink.extendObj(this._options,n||{}),this._init()};return s.prototype={_init:function(){this._handlers={click:Ink.bindEvent(this._onClick,this)},t.observe(this._element,"click",this._handlers.click);var e,s,a=o.select(this._options.node,this._element),l=!1;r.each(a,Ink.bind(function(t){s=o.select(this._options.child,t),s.length>0&&(n.addClassName(t,this._options.parentClass),l="true"===i.data(t).open,e=Ink.Dom.Selector.select("> "+this._options.iconTag,t)[0],e||(e=Ink.Dom.Element.create("i"),t.insertBefore(e,t.children[0])),l?n.addClassName(e,this._options.openClass):(n.addClassName(e,this._options.closedClass),t.setAttribute("data-open",!1),r.each(s,Ink.bind(function(e){n.addClassName(e,this._options.hideClass)},this))))},this))},_toggleClassNames:function(e,t){t=(""+t).split(/[ ,]+/),r.each(t,function(t){n.hasClassName(e,t)?n.removeClassName(e,t):n.addClassName(e,t)})},_onClick:function(e){var n=t.element(e);if(n=i.findUpwardsBySelector(n,this._options.node),n!==!1){var r,s,a=o.select(this._options.child,n);a.length>0&&(t.stop(e),a=a[0],this._toggleClassNames(a,this._options.hideClass),r="true"===i.data(n).open,s=n.children[0],r?n.setAttribute("data-open",!1):n.setAttribute("data-open",!0),this._toggleClassNames(s,this._options.openClass),this._toggleClassNames(s,this._options.closedClass))}}},s});
Ink.createModule("Ink.UI.FormValidator","2",["Ink.UI.Common_1","Ink.Dom.Element_1","Ink.Dom.Event_1","Ink.Dom.Selector_1","Ink.Dom.Css_1","Ink.Util.Array_1","Ink.Util.I18n_1","Ink.Util.Validator_1"],function(e,t,n,i,o,r,s,a){"use strict";var l={required:function(e){return"undefined"!=typeof e&&!/^\s*$/.test(e)},min_length:function(e,t){return"string"==typeof e&&e.length>=parseInt(t,10)},max_length:function(e,t){return"string"==typeof e&&e.length<=parseInt(t,10)},exact_length:function(e,t){return"string"==typeof e&&e.length===parseInt(t,10)},email:function(e){return"string"==typeof e&&a.mail(e)},url:function(e,t){return t=t||!1,"string"==typeof e&&a.url(e,t)},ip:function(e,t){return"string"!=typeof e?!1:a.isIP(e,t)},phone:function(e,t){if("string"!=typeof e)return!1;var n=t?t.toUpperCase():"";return a["is"+n+"Phone"](e)},credit_card:function(e,t){return"string"!=typeof e?!1:a.isCreditCard(e,t||"default")},date:function(e,t){return"string"==typeof e&&a.isDate(t,e)},alpha:function(e,t){return a.ascii(e,{singleLineWhitespace:t})},text:function(e,t,n){return a.unicode(e,{singleLineWhitespace:t,unicodePunctuation:n})},latin:function(e,t,n){return"string"!=typeof e?!1:a.latin1(e,{latin1Punctuation:t,singleLineWhitespace:n})},alpha_numeric:function(e){return a.ascii(e,{numbers:!0})},alpha_dash:function(e){return a.ascii(e,{dash:!0,underscore:!0})},digit:function(e){return"string"==typeof e&&/^[0-9]{1}$/.test(e)},integer:function(e,t){return a.number(e,{negative:!t,decimalPlaces:0})},decimal:function(e,t,n,i){return a.number(e,{decimalSep:t||".",decimalPlaces:+n||null,maxDigits:+i})},numeric:function(e,t,n,i){return t=t||".",-1!==e.indexOf(t)?l.decimal(e,t,n,i):l.integer(e)},range:function(e,t,n,i){return e=+e,t=+t,n=+n,isNaN(e)||isNaN(t)||isNaN(n)?!1:t>e||e>n?!1:i?0===(e-t)%i:!0},color:function(e){return a.isColor(e)},matches:function(e,t){return e===this.getFormElements()[t][0].getValue()}},u=new s({en_US:{"formvalidator.required":"The {field} filling is mandatory","formvalidator.min_length":"The {field} must have a minimum size of {param1} characters","formvalidator.max_length":"The {field} must have a maximum size of {param1} characters","formvalidator.exact_length":"The {field} must have an exact size of {param1} characters","formvalidator.email":"The {field} must have a valid e-mail address","formvalidator.url":"The {field} must have a valid URL","formvalidator.ip":"The {field} does not contain a valid {param1} IP address","formvalidator.phone":"The {field} does not contain a valid {param1} phone number","formvalidator.credit_card":"The {field} does not contain a valid {param1} credit card","formvalidator.date":"The {field} should contain a date in the {param1} format","formvalidator.alpha":"The {field} should only contain letters","formvalidator.text":"The {field} should only contain alphabetic characters","formvalidator.latin":"The {field} should only contain alphabetic characters","formvalidator.alpha_numeric":"The {field} should only contain letters or numbers","formvalidator.alpha_dashes":"The {field} should only contain letters or dashes","formvalidator.digit":"The {field} should only contain a digit","formvalidator.integer":"The {field} should only contain an integer","formvalidator.decimal":"The {field} should contain a valid decimal number","formvalidator.numeric":"The {field} should contain a number","formvalidator.range":"The {field} should contain a number between {param1} and {param2}","formvalidator.color":"The {field} should contain a valid color","formvalidator.matches":"The {field} should match the field {param1}","formvalidator.validation_function_not_found":"The rule {rule} has not been defined"},pt_PT:{"formvalidator.required":"Preencher {field} é obrigatório","formvalidator.min_length":"{field} deve ter no mínimo {param1} caracteres","formvalidator.max_length":"{field} tem um tamanho máximo de {param1} caracteres","formvalidator.exact_length":"{field} devia ter exactamente {param1} caracteres","formvalidator.email":"{field} deve ser um e-mail válido","formvalidator.url":"O {field} deve ser um URL válido","formvalidator.ip":"{field} não tem um endereço IP {param1} válido","formvalidator.phone":"{field} deve ser preenchido com um número de telefone {param1} válido.","formvalidator.credit_card":"{field} não tem um cartão de crédito {param1} válido","formvalidator.date":"{field} deve conter uma data no formato {param1}","formvalidator.alpha":"O campo {field} deve conter apenas caracteres alfabéticos","formvalidator.text":"O campo {field} deve conter apenas caracteres alfabéticos","formvalidator.latin":"O campo {field} deve conter apenas caracteres alfabéticos","formvalidator.alpha_numeric":"{field} deve conter apenas letras e números","formvalidator.alpha_dashes":"{field} deve conter apenas letras e traços","formvalidator.digit":"{field} destina-se a ser preenchido com apenas um dígito","formvalidator.integer":"{field} deve conter um número inteiro","formvalidator.decimal":"{field} deve conter um número válido","formvalidator.numeric":"{field} deve conter um número válido","formvalidator.range":"{field} deve conter um número entre {param1} e {param2}","formvalidator.color":"{field} deve conter uma cor válida","formvalidator.matches":"{field} deve corresponder ao campo {param1}","formvalidator.validation_function_not_found":"[A regra {rule} não foi definida]"}},"en_US"),c=function(n,i){this._element=e.elOrSelector(n,"Invalid FormElement"),this._errors={},this._rules={},this._value=null,this._options=Ink.extendObj({label:this._getLabel()},t.data(this._element)),this._options=Ink.extendObj(this._options,i||{})};c.prototype={_getLabel:function(){var e=t.findUpwardsByClass(this._element,"control-group"),n=Ink.s("label",e);return n=n?t.textContent(n):this._element.name||this._element.id||""},_parseRules:function(e){this._rules={},e=e.split("|");var t,n,i,o,r=e.length;if(r>0)for(t=0;r>t;t++)if(n=e[t])if(-1!==(o=n.indexOf("["))){i=n.substr(o+1),i=i.split("]"),i=i[0],i=i.split(",");for(var s=0,a=i.length;a>s;s++)i[s]="true"===i[s]?!0:"false"===i[s]?!1:i[s];i.splice(0,0,this.getValue()),n=n.substr(0,o),this._rules[n]=i}else this._rules[n]=[this.getValue()]},_addError:function(e){for(var t=this._rules[e]||[],n={field:this._options.label,value:this.getValue()},i=1;i<t.length;i++)n["param"+i]=t[i];var o="formvalidator."+e;this._errors[e]=u.text(o,n),this._errors[e]===o&&(this._errors[e]="Validation message not found")},getValue:function(){switch(this._element.nodeName.toLowerCase()){case"select":return Ink.s("option:selected",this._element).value;case"textarea":return this._element.innerHTML;case"input":if(!("type"in this._element))return this._element.value;if("radio"===this._element.type&&"checkbox"===this._element.type){if(this._element.checked)return this._element.value}else if("file"!==this._element.type)return this._element.value;return;default:return this._element.innerHTML}},getErrors:function(){return this._errors},getElement:function(){return this._element},getFormElements:function(){return this._options.form._formElements},validate:function(){if(this._errors={},this._parseRules(this._options.rules),"required"in this._rules||""!==this.getValue())for(var e in this._rules)if(this._rules.hasOwnProperty(e)){if("function"!=typeof l[e])return this._addError(null),!1;if(l[e].apply(this,this._rules[e])===!1)return this._addError(e),!1}return!0}};var h=function(i,o){this._rootElement=e.elOrSelector(i),this._formElements={},this._errorMessages=[],this._markedErrorElements=[],this._options=Ink.extendObj({eventTrigger:"submit",neverSubmit:"false",cancelEventOnSuccess:"false",searchFor:"input, select, textarea, .control-group",beforeValidation:void 0,onError:void 0,onSuccess:void 0},t.data(this._rootElement)),this._options=Ink.extendObj(this._options,o||{}),"string"==typeof this._options.eventTrigger&&n.observe(this._rootElement,this._options.eventTrigger,Ink.bindEvent(this.validate,this)),this._init()};return h.setRule=function(e,t,n){if(l[e]=n,u.getKey("formvalidator."+e)!==t){var i={};i["formvalidator."+e]=t;var o={};o[u.lang()]=i,u.append(o)}},h.getI18n=function(){return u},h.setI18n=function(e){u=e},h.appendI18n=function(){u.append.apply(u,[].slice.call(arguments))},h.setLanguage=function(e){u.lang(e)},h.getRules=function(){return l},h.prototype={_init:function(){},getElements:function(){this._formElements={};var e=i.select(this._options.searchFor,this._rootElement);if(e.length){var n,o;for(n=0;n<e.length;n+=1){o=e[n];var r=t.data(o);if("rules"in r){var s,a={form:this};"name"in o&&o.name?s=o.name:"id"in o&&o.id?s=o.id:(s="element_"+Math.floor(100*Math.random()),o.id=s),s in this._formElements?this._formElements[s].push(new c(o,a)):this._formElements[s]=[new c(o,a)]}}}return this._formElements},validate:function(e){"true"==this._options.neverSubmit+""&&e&&n.stopDefault(e),"function"==typeof this._options.beforeValidation&&this._options.beforeValidation(),this.getElements();var i=[];for(var s in this._formElements)if(this._formElements.hasOwnProperty(s))for(var a=0;a<this._formElements[s].length;a+=1)this._formElements[s][a].validate()||i.push(this._formElements[s][a]);return 0===i.length?("function"==typeof this._options.onSuccess&&this._options.onSuccess(),e&&"true"===this._options.cancelEventOnSuccess.toString()?(n.stopDefault(e),!1):!0):(e&&n.stopDefault(e),"function"==typeof this._options.onError&&this._options.onError(i),r.each(this._markedErrorElements,function(){o.removeClassName(["validation","error"])}),r.each(this._errorMessages,t.remove),this._errorMessages=[],this._markedErrorElements=[],r.each(i,Ink.bind(function(e){var n,i;o.hasClassName(e.getElement(),"control-group")?(n=e.getElement(),i=Ink.s(".control",e.getElement())):(n=t.findUpwardsByClass(e.getElement(),"control-group"),i=t.findUpwardsByClass(e.getElement(),"control")),i&&n||(i=n=e.getElement()),o.addClassName(n,["validation","error"]),this._markedErrorElements.push(n);var r=document.createElement("p");o.addClassName(r,"tip"),t.insertAfter(r,i);var s=e.getErrors(),a=[];for(var l in s)s.hasOwnProperty(l)&&a.push(s[l]);r.innerHTML=a.join("<br/>"),this._errorMessages.push(r)},this)),!1)}},h});
Ink.createModule("Ink.UI.FormValidator","1",["Ink.Dom.Element_1","Ink.Dom.Css_1","Ink.Util.Validator_1"],function(e,t,n){"use strict";var i={version:"1",_flagMap:{"ink-fv-required":{msg:"Required field"},"ink-fv-email":{msg:"Invalid e-mail address"},"ink-fv-url":{msg:"Invalid URL"},"ink-fv-number":{msg:"Invalid number"},"ink-fv-phone_pt":{msg:"Invalid phone number"},"ink-fv-phone_cv":{msg:"Invalid phone number"},"ink-fv-phone_mz":{msg:"Invalid phone number"},"ink-fv-phone_ao":{msg:"Invalid phone number"},"ink-fv-date":{msg:"Invalid date"},"ink-fv-confirm":{msg:"Confirmation does not match"},"ink-fv-custom":{msg:""}},elements:{},confirmElms:{},hasConfirm:{},_errorClassName:"tip",_errorValidationClassName:"validaton",_errorTypeWarningClassName:"warning",_errorTypeErrorClassName:"error",validate:function(e,t){if(this._free(),t=Ink.extendObj({onSuccess:!1,onError:!1,customFlag:!1,confirmGroup:[]},t||{}),"string"==typeof e&&(e=document.getElementById(e)),null===e)return!1;this.element=e,("undefined"==typeof this.element.id||null===this.element.id||""===this.element.id)&&(this.element.id="ink-fv_randomid_"+Math.round(99999*Math.random())),this.custom=t.customFlag,this.confirmGroup=t.confirmGroup;var n=this._validateElements();return n.length>0?(t.onError?t.onError(n):this._showError(e,n),!1):(t.onError||this._clearError(e),this._clearCache(),t.onSuccess&&t.onSuccess(),!0)},reset:function(){this._clearError(),this._clearCache()},_free:function(){this.element=null,this.custom=!1,this.confirmGroup=!1},_clearCache:function(){this.element=null,this.elements=[],this.custom=!1,this.confirmGroup=!1},_getElements:function(){this.elements[this.element.id]=[],this.confirmElms[this.element.id]=[];for(var e=this.element.elements,n=!1,i=0,r=e.length;r>i;i++)if(n=e[i],null!==n.getAttribute("type")&&"radio"===n.getAttribute("type").toLowerCase()){if(0===this.elements[this.element.id].length||n.getAttribute("type")!==this.elements[this.element.id][this.elements[this.element.id].length-1].getAttribute("type")&&n.getAttribute("name")!==this.elements[this.element.id][this.elements[this.element.id].length-1].getAttribute("name"))for(var o in this._flagMap)if(t.hasClassName(n,o)){this.elements[this.element.id].push(n);break}}else{for(var s in this._flagMap)if(t.hasClassName(n,s)&&"ink-fv-confirm"!==s){this.elements[this.element.id].push(n);break}t.hasClassName(n,"ink-fv-confirm")&&(this.confirmElms[this.element.id].push(n),this.hasConfirm[this.element.id]=!0)}},_validateElements:function(){var e;this._getElements(),"undefined"!=typeof this.hasConfirm[this.element.id]&&this.hasConfirm[this.element.id]===!0&&(e=this._makeConfirmGroups());for(var n,i=[],r=!1,o=!1,s=0,a=this.elements[this.element.id].length;a>s;s++)if(n=!1,r=this.elements[this.element.id][s],!r.disabled)for(var l in this._flagMap)if(t.hasClassName(r,l))if("ink-fv-custom"!==l&&"ink-fv-confirm"!==l)this._isValid(r,l)||(n?i[i.length-1].errors.push(l):(i.push({elm:r,errors:[l]}),n=!0));else if("ink-fv-confirm"!==l)o=this._isCustomValid(r),o.length>0&&i.push({elm:r,errors:[l],custom:o});else if("ink-fv-confirm"===l)continue;return i=this._validateConfirmGroups(e,i)},_validateConfirmGroups:function(e,t){var n=!1;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],2===n.length&&n[0].value!==n[1].value&&t.push({elm:n[1],errors:["ink-fv-confirm"]}));return t},_makeConfirmGroups:function(){var e;if(this.confirmGroup&&this.confirmGroup.length>0){e={};for(var n=!1,i=!1,r=0,o=this.confirmElms[this.element.id].length;o>r;r++){n=this.confirmElms[this.element.id][r];for(var s=0,a=this.confirmGroup.length;a>s;s++)i=this.confirmGroup[s],t.hasClassName(n,i)&&("undefined"==typeof e[i]?e[i]=[n]:e[i].push(n))}return e}return 2===this.confirmElms[this.element.id].length&&(e={"ink-fv-confirm":[this.confirmElms[this.element.id][0],this.confirmElms[this.element.id][1]]}),e},_isCustomValid:function(e){for(var n=[],i=!1,r=0,o=this.custom.length;o>r;r++)i=this.custom[r],t.hasClassName(e,i.flag)&&(i.callback(e,i.msg)||n.push({flag:i.flag,msg:i.msg}));return n},_isValid:function(e,i){var r=e.nodeName.toLowerCase(),o=(e.getAttribute("type")||"").toLowerCase(),s=this._trim(e.value);if("ink-fv-required"!==i&&"checkbox"!==o&&"radio"!==o&&""===s)return!t.hasClassName(e,"ink-fv-required");switch(i){case"ink-fv-required":if("select"===r)return e.selectedIndex>0?!0:!1;if("checkbox"!==o&&"radio"!==o&&""!==s)return!0;if("checkbox"===o){if(e.checked===!0)return!0}else if("radio"===o){var a=e.form[e.name];"undefined"==typeof a.length&&(a=[a]);for(var l=!1,u=0,h=a.length;h>u;u++)a[u].checked===!0&&(l=!0);return l}return!1;case"ink-fv-email":return n.mail(e.value);case"ink-fv-url":return n.url(e.value);case"ink-fv-number":return!isNaN(Number(e.value))&&isFinite(Number(e.value));case"ink-fv-phone_pt":return n.isPTPhone(e.value);case"ink-fv-phone_cv":return n.isCVPhone(e.value);case"ink-fv-phone_ao":return n.isAOPhone(e.value);case"ink-fv-phone_mz":return n.isMZPhone(e.value);case"ink-fv-date":var c=Ink.getModule("Ink.Dom.Element",1),d=c.data(e),f="yyyy-mm-dd";if(t.hasClassName(e,"ink-datepicker")&&"format"in d?f=d.format:"validFormat"in d&&(f=d.validFormat),!(f in n._dateParsers)){var m=[];for(var p in n._dateParsers)n._dateParsers.hasOwnProperty(p)&&m.push(p);throw new Error("The attribute data-valid-format must be one of the following values: "+m.join(", "))}return n.isDate(f,e.value);case"ink-fv-custom":}return!1},_showError:function(e,t){this._clearError(e);for(var n=!1,i=0,r=t.length;r>i;i++)n=t[i].elm,n&&this._showAnErrorOnElement(n,t[i])},_showAnErrorOnElement:function(n,i){var r=e.findUpwardsByClass(n,"control-group"),o=e.findUpwardsByClass(n,"control"),s=n.getAttribute("type");if("radio"!==s){var a=[this._errorClassName,this._errorTypeClassName].join(" "),l=e.create("p",{className:a});l.innerHTML="ink-fv-custom"!==i.errors[0]?this._flagMap[i.errors[0]].msg:i.custom[0].msg,"checkbox"!==s&&(n.nextSibling?e.insertAfter(l,n):n.parentNode.appendChild(l),o&&("ink-fv-required"===i.errors[0]?t.addClassName(r,"validation error"):t.addClassName(r,"validation warning")))}else r&&t.addClassName(r,["validation","error"])},_clearError:function(e){for(var n=e.getElementsByTagName("p"),i=!1,r=n.length-1;r>=0;r--)i=n[r],t.hasClassName(i,this._errorClassName)&&(t.hasClassName(i.parentNode,"control")&&(t.removeClassName(i.parentNode.parentNode,"validation"),t.removeClassName(i.parentNode.parentNode,"error"),t.removeClassName(i.parentNode.parentNode,"warning")),t.hasClassName(i,"tip")&&t.hasClassName(i,"error")&&i.parentNode.removeChild(i));var o=e.getElementsByTagName("ul");for(r=o.length-1;r>=0;r--)i=o[r],t.hasClassName(i,"control-group")&&(t.removeClassName(i,"validation"),t.removeClassName(i,"error"))},_trim:function(e){return"string"==typeof e?e.replace(/^\s+|\s+$|\n+$/g,""):void 0}};return i});
Ink.createModule("Ink.UI.Droppable","1",["Ink.Dom.Element_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.UI.Common_1","Ink.Util.Array_1","Ink.Dom.Selector_1"],function(e,t,n,i,r,o){"use strict";var s=function(e){return function(t){return n.addClassName(e,t)}},a=function(e){return function(t){return n.removeClassName(e,t)}},l={debug:!1,_droppables:[],_draggables:[],add:function(t,n){function r(e){e.style.position="inherit"}t=i.elOrSelector(t,"Droppable.add target element");var o=Ink.extendObj({hoverClass:n.hoverclass||!1,accept:!1,onHover:!1,onDrop:!1,onDropOut:!1},n||{},e.data(t));"string"==typeof o.hoverClass&&(o.hoverClass=o.hoverClass.split(/\s+/));var s,a=this,l={move:function(e,t){r(e),t.appendChild(e)},copy:function(e,t){r(e),t.appendChild(e.cloneNode)},revert:function(e){a._findDraggable(e).originalParent.appendChild(e),r(e)}};if("string"==typeof o.onHover&&(s=o.onHover,o.onHover=l[s],void 0===o.onHover))throw new Error("Unknown hover event handler: "+s);if("string"==typeof o.onDrop&&(s=o.onDrop,o.onDrop=l[s],void 0===o.onDrop))throw new Error("Unknown drop event handler: "+s);if("string"==typeof o.onDropOut&&(s=o.onDropOut,o.onDropOut=l[s],void 0===o.onDropOut))throw new Error("Unknown dropOut event handler: "+s);var u={element:t,data:{},options:o};this._droppables.push(u),this._update(u)},_findData:function(e){for(var t=this._droppables,n=0,i=t.length;i>n;n++)if(t[n].element===e)return t[n]},_findDraggable:function(e){for(var t=this._draggables,n=0,i=t.length;i>n;n++)if(t[n].element===e)return t[n]},updateAll:function(){r.each(this._droppables,l._update)},update:function(e){this._update(this._findData(e))},_update:function(t){var n=t.data,i=t.element;n.left=e.offsetLeft(i),n.top=e.offsetTop(i),n.right=n.left+e.elementWidth(i),n.bottom=n.top+e.elementHeight(i)},remove:function(e){e=i.elOrSelector(e);for(var t=this._droppables.length,n=0;t>n;n++)if(this._droppables[n].element===e){this._droppables.splice(n,1);break}return t!==this._droppables.length},action:function(e,t,n,i){r.each(this._droppables,Ink.bind(function(l){var u=l.data,h=l.options,c=l.element;(!h.accept||o.matches(h.accept,[i]).length)&&("drag"!==t||this._findDraggable(i)||this._draggables.push({element:i,originalParent:i.parentNode}),e.x>=u.left&&e.x<=u.right&&e.y>=u.top&&e.y<=u.bottom?"drag"===t?(h.hoverClass&&r.each(h.hoverClass,s(c)),h.onHover&&h.onHover(i,c)):"drop"===t&&(h.hoverClass&&r.each(h.hoverClass,a(c)),h.onDrop&&h.onDrop(i,c,n)):"drag"===t&&h.hoverClass?r.each(h.hoverClass,a(c)):"drop"===t&&h.onDropOut&&h.onDropOut(i,c,n))},this))}};return l});
Ink.createModule("Ink.UI.Dropdown","1",["Ink.UI.Common_1","Ink.UI.Toggle_1","Ink.Dom.Event_1","Ink.Dom.Element_1"],function(e,t,n,i){"use strict";function o(e,t){this._init(e,t)}return o.prototype={_init:function(i,o){this._element=e.elOrSelector(i),this._options=e.options("Ink.UI.Dropdown_1",{target:["Element"],hoverOpen:["Number",null],dismissOnInsideClick:["Boolean",!0],dismissOnOutsideClick:["Boolean",!0],dismissAfter:["Number",null],onInsideClick:["Function",null],onOutsideClick:["Function",null],onOpen:["Function",null],onDismiss:["Function",null]},o||{},this._element),this._toggle=new t(this._element,{target:this._options.target,closeOnInsideClick:null,closeOnClick:!1,onChangeState:Ink.bind(function(e){return this._openOrDismiss(e,!0,!0)},this)}),n.observeMulti([this._options.target,this._element],"mouseout",Ink.bindMethod(this,"_onMouseOut")),n.observeMulti([this._options.target,this._element],"mouseover",Ink.bindMethod(this,"_onMouseOver")),n.observe(this._options.target,"click",Ink.bindMethod(this,"_onInsideClick")),n.observe(document.body,"click",Ink.bindMethod(this,"_onOutsideClick"))},_onMouseOver:function(){this._options.hoverOpen&&this._toggle.getState()===!1&&(clearTimeout(this._openTimeout),this._openTimeout=setTimeout(Ink.bindMethod(this,"open",!0),1e3*this._options.hoverOpen)),this._options.dismissAfter&&clearTimeout(this._dismissTimeout)},_onMouseOut:function(){this._options.dismissAfter&&this._toggle.getState()===!0&&(clearTimeout(this._dismissTimeout),this._dismissTimeout=setTimeout(Ink.bindMethod(this,"dismiss",!0),1e3*this._options.dismissAfter)),this._options.hoverOpen&&clearTimeout(this._openTimeout)},_onInsideClick:function(e){var t=this._handlerCall("onInsideClick",n.element(e));return t===!1?!1:(this._options.dismissOnInsideClick&&this.dismiss(!0),n.stop(e),void 0)},_onOutsideClick:function(e){var t=n.element(e),o=i.findUpwardsHaving(t,Ink.bind(function(e){return e===this._element},this)),r=i.findUpwardsHaving(t,Ink.bind(function(e){return e===this._options.target},this));if(!o&&!r){var s=this._handlerCall("onOutsideClick",t);if(s===!1)return!1;this._options.dismissOnOutsideClick&&this.dismiss(!0),n.stop(e)}},dismiss:function(e,t){this._openOrDismiss(!1,e,t)},open:function(e,t){this._openOrDismiss(!0,e,t)},_openOrDismiss:function(e,t,n){if(!this._toggle||this._toggle.getState()!==e){if(t&&this._handlerCall(e?"onOpen":"onDismiss")===!1)return!1;n||this._toggle.setState(e),clearTimeout(this._dismissTimeout),clearTimeout(this._openTimeout)}},_handlerCall:function(e){return this._options[e]?this._options[e].call(this,[].slice.call(arguments,1)):void 0}},o});
Ink.createModule("Ink.UI.Draggable","1",["Ink.Dom.Element_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Browser_1","Ink.Dom.Selector_1","Ink.UI.Common_1"],function(e,t,n,i,o,r){"use strict";function s(e,t,n){return e=Math.min(e,n),e=Math.max(e,t)}var a=0,l=1,h=function(e,t){this.init(e,t)};return h.prototype={init:function(n,o){var s=Ink.extendObj({constraint:!1,constraintElm:!1,top:!1,right:!1,bottom:!1,left:!1,handle:o.handler||!1,revert:!1,cursor:"move",zindex:o.zindex||9999,dragClass:"drag",onStart:!1,onEnd:!1,onDrag:!1,onChange:!1,droppableProxy:!1,mouseAnchor:void 0,skipChildren:!0,fps:100,debug:!1},o||{},e.data(n));this.options=s,this.element=r.elOrSelector(n),this.constraintElm=s.constraintElm&&r.elOrSelector(s.constraintElm),this.handle=!1,this.elmStartPosition=!1,this.active=!1,this.dragged=!1,this.prevCoords=!1,this.placeholder=!1,this.position=!1,this.zindex=!1,this.firstDrag=!0,s.fps&&(this.deltaMs=1e3/s.fps,this.lastRunAt=0),this.handlers={},this.handlers.start=Ink.bindEvent(this._onStart,this),this.handlers.dragFacade=Ink.bindEvent(this._onDragFacade,this),this.handlers.drag=Ink.bindEvent(this._onDrag,this),this.handlers.end=Ink.bindEvent(this._onEnd,this),this.handlers.selectStart=function(e){return t.stop(e),!1},this.handle=this.options.handle?r.elOrSelector(this.options.handle):this.element,this.handle.style.cursor=s.cursor,t.observe(this.handle,"touchstart",this.handlers.start),t.observe(this.handle,"mousedown",this.handlers.start),i.IE&&t.observe(this.element,"selectstart",this.handlers.selectStart)},destroy:function(){t.stopObserving(this.handle,"touchstart",this.handlers.start),t.stopObserving(this.handle,"mousedown",this.handlers.start),i.IE&&t.stopObserving(this.element,"selectstart",this.handlers.selectStart)},_getCoords:function(t){var n=[e.scrollWidth(),e.scrollHeight()];return{x:(t.touches?t.touches[0].clientX:t.clientX)+n[a],y:(t.touches?t.touches[0].clientY:t.clientY)+n[l]}},_cloneStyle:function(t,i){i.className=t.className,i.style.borderWidth="0",i.style.padding="0",i.style.position="absolute",i.style.width=e.elementWidth(t)+"px",i.style.height=e.elementHeight(t)+"px",i.style.left=e.elementLeft(t)+"px",i.style.top=e.elementTop(t)+"px",i.style.cssFloat=n.getStyle(t,"float"),i.style.display=n.getStyle(t,"display")},_onStart:function(i){if(!this.active&&t.isLeftClick(i)||"undefined"==typeof i.button){var o=t.element(i);if(this.options.skipChildren&&o!==this.handle)return;t.stop(i),n.addClassName(this.element,this.options.dragClass),this.elmStartPosition=[e.elementLeft(this.element),e.elementTop(this.element)];var r=[parseInt(n.getStyle(this.element,"left"),10),parseInt(n.getStyle(this.element,"top"),10)],s=e.elementDimensions(this.element);this.originalPosition=[r[a]?r[a]:null,r[l]?r[l]:null],this.delta=this._getCoords(i),this.active=!0,this.position=n.getStyle(this.element,"position"),this.zindex=n.getStyle(this.element,"zIndex");var h=document.createElement("div");if(h.style.position=this.position,h.style.width=s[a]+"px",h.style.height=s[l]+"px",h.style.marginTop=n.getStyle(this.element,"margin-top"),h.style.marginBottom=n.getStyle(this.element,"margin-bottom"),h.style.marginLeft=n.getStyle(this.element,"margin-left"),h.style.marginRight=n.getStyle(this.element,"margin-right"),h.style.borderWidth="0",h.style.padding="0",h.style.cssFloat=n.getStyle(this.element,"float"),h.style.display=n.getStyle(this.element,"display"),h.style.visibility="hidden",this.delta2=[this.delta.x-this.elmStartPosition[a],this.delta.y-this.elmStartPosition[l]],this.options.mouseAnchor){var u=this.options.mouseAnchor.split(" "),d=[s[a],s[l]];"left"===u[0]?d[a]=0:"center"===u[0]&&(d[a]=parseInt(d[a]/2,10)),"top"===u[1]?d[l]=0:"center"===u[1]&&(d[l]=parseInt(d[l]/2,10)),this.applyDelta=[this.delta2[a]-d[a],this.delta2[l]-d[l]]}var c=this.options.fps?"dragFacade":"drag";if(this.placeholder=h,this.options.onStart&&this.options.onStart(this.element,i),this.options.droppableProxy){this.proxy=document.createElement("div"),s=[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight];var f=this.proxy.style;f.width=s[a]+"px",f.height=s[l]+"px",f.position="fixed",f.left="0",f.top="0",f.zIndex=this.options.zindex+1,f.backgroundColor="#FF0000",n.setOpacity(this.proxy,0);for(var p=document.body.firstChild;p&&1!==p.nodeType;)p=p.nextSibling;document.body.insertBefore(this.proxy,p),t.observe(this.proxy,"mousemove",this.handlers[c]),t.observe(this.proxy,"touchmove",this.handlers[c])}else t.observe(document,"mousemove",this.handlers[c]);return this.element.style.position="absolute",this.element.style.zIndex=this.options.zindex,this.element.parentNode.insertBefore(this.placeholder,this.element),this._onDrag(i),t.observe(document,"mouseup",this.handlers.end),t.observe(document,"touchend",this.handlers.end),!1}},_onDragFacade:function(e){var t=+new Date;(!this.lastRunAt||t>this.lastRunAt+this.deltaMs)&&(this.lastRunAt=t,this._onDrag(e))},_onDrag:function(n){if(this.active){t.stop(n),this.dragged=!0;var i=this._getCoords(n),o=i.x,r=i.y,h=this.options,u=!1,d=!1;if(this.prevCoords&&o!==this.prevCoords.x||r!==this.prevCoords.y){h.onDrag&&h.onDrag(this.element,n),this.prevCoords=i,u=this.elmStartPosition[a]+o-this.delta.x,d=this.elmStartPosition[l]+r-this.delta.y;var c=e.elementDimensions(this.element);if(this.constraintElm){var f=e.offset(this.constraintElm),p=e.elementDimensions(this.constraintElm),m=f[l]+(h.top||0),g=f[l]+p[l]-(h.bottom||0),v=f[a]+(h.left||0),_=f[a]+p[a]-(h.right||0);d=s(d,m,g-c[l]),u=s(u,v,_-c[a])}else if(h.constraint){var y=h.right===!1?e.pageWidth()-c[a]:h.right,b=h.left===!1?0:h.left,w=h.top===!1?0:h.top,k=h.bottom===!1?e.pageHeight()-c[l]:h.bottom;("horizontal"===h.constraint||"both"===h.constraint)&&(u=s(u,b,y)),("vertical"===h.constraint||"both"===h.constraint)&&(d=s(d,w,k))}var C=Ink.getModule("Ink.UI.Droppable_1");if(this.firstDrag&&(C&&C.updateAll(),this.firstDrag=!1),u&&(this.element.style.left=u+"px"),d&&(this.element.style.top=d+"px"),C){var I=this.options.mouseAnchor?{x:o-this.applyDelta[a],y:r-this.applyDelta[l]}:i;C.action(I,"drag",n,this.element)}h.onChange&&h.onChange(this)}}},_onEnd:function(i){if(t.stopObserving(document,"mousemove",this.handlers.drag),t.stopObserving(document,"touchmove",this.handlers.drag),this.options.fps&&this._onDrag(i),n.removeClassName(this.element,this.options.dragClass),this.active&&this.dragged){this.options.droppableProxy&&document.body.removeChild(this.proxy),this.pt&&(e.remove(this.pt),this.pt=void 0),this.placeholder&&e.remove(this.placeholder),this.options.revert&&(this.element.style.position=this.position,this.element.style.zIndex=null!==this.zindex?this.zindex:"auto",this.element.style.left=this.originalPosition[a]?this.originalPosition[a]+"px":"",this.element.style.top=this.originalPosition[l]?this.originalPosition[l]+"px":""),this.options.onEnd&&this.options.onEnd(this.element,i);var o=Ink.getModule("Ink.UI.Droppable_1");o&&o.action(this._getCoords(i),"drop",i,this.element),this.position=!1,this.zindex=!1,this.firstDrag=!0}this.active=!1,this.dragged=!1}},h});
Ink.createModule("Ink.UI.DatePicker","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1","Ink.Util.Date_1","Ink.Dom.Browser_1"],function(e,t,n,i,o,r,s){"use strict";function a(e,t){for(var n="",i=0;e>i;i++)n+=t;return n}function l(e,t,n){return e>n&&(e=n),t>e&&(e=t),e}function h(e){var t=e.split("-");return d(+t[0],+t[1]-1,+t[2])}function d(e,t,n){return{_year:e,_month:t,_day:n}}function c(e){return{_year:e.getFullYear(),_month:e.getMonth(),_day:e.getDate()}}var u=function(t,n){if(this._dataField=t&&e.elOrSelector(t,"[Ink.UI.DatePicker_1]: selector argument"),this._options=e.options("Ink.UI.DatePicker_1",{autoOpen:["Boolean",!1],cleanText:["String","Clear"],closeText:["String","Close"],containerElement:["Element",null],cssClass:["String","ink-calendar"],dateRange:["String",null],displayInSelect:["Boolean",!1],dayField:["Element",null],monthField:["Element",null],yearField:["Element",null],format:["String","yyyy-mm-dd"],instance:["String","scdp_"+Math.round(99999*Math.random())],nextLinkText:["String","»"],ofText:["String","&nbsp;de&nbsp;"],onFocus:["Boolean",!0],onMonthSelected:["Function",null],onSetDate:["Function",null],onYearSelected:["Function",null],position:["String","right"],prevLinkText:["String","«"],showClean:["Boolean",!0],showClose:["Boolean",!0],shy:["Boolean",!0],startDate:["String",null],startWeekDay:["Number",1],validDayFn:["Function",null],validMonthFn:["Function",null],validYearFn:["Function",null],nextValidDateFn:["Function",null],prevValidDateFn:["Function",null],yearRange:["String",null],month:["Object",{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"}],wDay:["Object",{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"}]},n||{},this._dataField),this._options.format=this._dateParsers[this._options.format]||this._options.format,this._hoverPicker=!1,this._picker=this._options.pickerField&&e.elOrSelector(this._options.pickerField,"pickerField"),this._setMinMax(this._options.dateRange||this._options.yearRange),this._options.startDate)this.setDate(this._options.startDate);else if(this._dataField&&this._dataField.value)this.setDate(this._dataField.value);else{var i=new Date;this._day=i.getDate(),this._month=i.getMonth(),this._year=i.getFullYear()}if(this._options.displayInSelect&&!(this._options.dayField&&this._options.monthField&&this._options.yearField))throw new Error("Ink.UI.DatePicker: displayInSelect option enabled.Please specify dayField, monthField and yearField selectors.");this._init()};return u.prototype={version:"0.1",_init:function(){Ink.extendObj(this._options,this._lang||{}),this._render(),this._listenToContainerObjectEvents(),e.registerInstance(this,this._containerObject,"datePicker")},_render:function(){this._containerObject=document.createElement("div"),this._containerObject.id=this._options.instance,this._containerObject.className=this._options.cssClass,this._renderSuperTopBar();var t=document.createElement("div");t.className="ink-calendar-top",this._monthDescContainer=document.createElement("div"),this._monthDescContainer.className="ink-calendar-month_desc",this._monthPrev=document.createElement("div"),this._monthPrev.className="ink-calendar-prev",this._monthPrev.innerHTML='<a href="#prev" class="change_month_prev">'+this._options.prevLinkText+"</a>",this._monthNext=document.createElement("div"),this._monthNext.className="ink-calendar-next",this._monthNext.innerHTML='<a href="#next" class="change_month_next">'+this._options.nextLinkText+"</a>",t.appendChild(this._monthPrev),t.appendChild(this._monthDescContainer),t.appendChild(this._monthNext),this._monthContainer=document.createElement("div"),this._monthContainer.className="ink-calendar-month",this._containerObject.appendChild(t),this._containerObject.appendChild(this._monthContainer),this._monthSelector=this._renderMonthSelector(),this._containerObject.appendChild(this._monthSelector),this._yearSelector=document.createElement("ul"),this._yearSelector.className="ink-calendar-year-selector",this._containerObject.appendChild(this._yearSelector),(!this._options.onFocus||this._options.displayInSelect)&&(this._options.pickerField?this._picker=e.elOrSelector(this._options.pickerField,"pickerField"):(this._picker=document.createElement("a"),this._picker.href="#open_cal",this._picker.innerHTML="open",this._dataField.parentNode.appendChild(this._picker),this._picker.className="ink-datepicker-picker-field")),this._appendDatePickerToDom(),this._renderMonth(),this._monthChanger=document.createElement("a"),this._monthChanger.href="#monthchanger",this._monthChanger.className="ink-calendar-link-month",this._monthChanger.innerHTML=this._options.month[this._month+1],this._deText=document.createElement("span"),this._deText.innerHTML=this._options._deText,this._yearChanger=document.createElement("a"),this._yearChanger.href="#yearchanger",this._yearChanger.className="ink-calendar-link-year",this._yearChanger.innerHTML=this._year,this._monthDescContainer.innerHTML="",this._monthDescContainer.appendChild(this._monthChanger),this._monthDescContainer.appendChild(this._deText),this._monthDescContainer.appendChild(this._yearChanger),this._options.inline?this._openInline():this._addOpenCloseEvents(),this._addDateChangeHandlersToInputs()},_addDateChangeHandlersToInputs:function(){var e=this._dataField;this._options.displayInSelect&&(e=[this._options.dayField,this._options.monthField,this._options.yearField]),t.observeMulti(e,"change",Ink.bindEvent(function(){this._updateDate(),this._showDefaultView(),this.setDate(),this._inline||this._hoverPicker||this._hide(!0)},this))},_addOpenCloseEvents:function(){var e=this._picker||this._dataField;t.observe(e,"click",Ink.bindEvent(function(n){t.stop(n),this._containerObject=i.clonePosition(this._containerObject,e);var o,r,s=e.getBoundingClientRect();"bottom"===this._options.position?(o=s.bottom,r=s.left):(o=s.top,r=s.right),o+=i.scrollHeight(),r+=i.scrollWidth(),this._containerObject.style.top=o+"px",this._containerObject.style.left=r+"px",this._updateDate(),this._renderMonth(),this._containerObject.style.display="block"},this)),this._options.autoOpen&&(this._containerObject=i.clonePosition(this._containerObject,e),this._updateDate(),this._renderMonth(),this._containerObject.style.display="block"),this._options.displayInSelect||t.observe(e,"blur",Ink.bindEvent(function(){this._hoverPicker||this._hide(!0)},this)),this._options.shy&&t.observe(document,"click",Ink.bindEvent(function(e){for(var n=t.element(e),o=[this._options.dayField,this._options.monthField,this._options.yearField,this._picker,this._dataField],r=0,s=o.length;s>r;r++)if(o[r]&&i.descendantOf(o[r],n))return;this._hide(!0)},this))},_openInline:function(){this._updateDate(),this._renderMonth(),this._containerObject.style.display="block"},_renderMonthSelector:function(){var e=document.createElement("ul");e.className="ink-calendar-month-selector";for(var t=document.createElement("ul"),n=1;12>=n;n++)t.appendChild(this._renderMonthButton(n)),0===n%4&&(e.appendChild(t),t=document.createElement("ul"));return e},_renderMonthButton:function(e){var t=document.createElement("li"),n=document.createElement("a");return n.setAttribute("data-cal-month",e),n.innerHTML=this._options.month[e].substring(0,3),t.appendChild(n),t},_appendDatePickerToDom:function(){var t=document.body;if(this._options.containerElement)t=Ink.i(this._options.containerElement)||e.elOrSelector(this._options.containerElement);else if(this._options.inline)return i.insertAfter(this._containerObject,this._dataField),void 0;t.appendChild(this._containerObject)},_renderSuperTopBar:function(){this._options.showClose&&this._options.showClean&&(this._superTopBar=document.createElement("div"),this._superTopBar.className="ink-calendar-top-options",this._options.showClean&&this._superTopBar.appendChild(i.create("a",{className:"clean",setHTML:this._options.cleanText})),this._options.showClose&&this._superTopBar.appendChild(i.create("a",{className:"close",setHTML:this._options.closeText})),this._containerObject.appendChild(this._superTopBar))},_listenToContainerObjectEvents:function(){t.observe(this._containerObject,"mouseover",Ink.bindEvent(function(e){t.stop(e),this._hoverPicker=!0},this)),t.observe(this._containerObject,"mouseout",Ink.bindEvent(function(e){t.stop(e),this._hoverPicker=!1},this)),t.observe(this._containerObject,"click",Ink.bindEvent(this._onClick,this))},_onClick:function(e){var i=t.element(e);return n.hasClassName("ink-calendar-off")?null:(t.stop(e),this._onRelativeChangerClick(i),this._onAbsoluteChangerClick(i),n.hasClassName(i,"ink-calendar-link-month")?this._showMonthSelector():n.hasClassName(i,"ink-calendar-link-year")?this._showYearSelector():n.hasClassName(i,"clean")?this._clean():n.hasClassName(i,"close")&&this._hide(!1),this._updateDescription(),void 0)},_onRelativeChangerClick:function(e){var t={change_year_next:1,change_year_prev:-1},n={change_month_next:1,change_month_prev:-1};e.className in n?this._updateCal(n[e.className]):e.className in t&&this._showYearSelector(t[e.className])},_onAbsoluteChangerClick:function(e){var t=i.data(e);Number(t.calDay)?(this.setDate([this._year,this._month+1,t.calDay].join("-")),this._hide()):Number(t.calMonth)?(this._month=Number(t.calMonth)-1,this._showDefaultView(),this._updateCal()):Number(t.calYear)&&this._changeYear(Number(t.calYear))},_changeYear:function(e){e=+e,e&&(this._year=e,"function"==typeof this._options.onYearSelected&&this._options.onYearSelected(this,{year:this._year}),this._showMonthSelector())},_clean:function(){this._options.displayInSelect?(this._options.yearField.selectedIndex=0,this._options.monthField.selectedIndex=0,this._options.dayField.selectedIndex=0):this._dataField.value=""},_hide:function(e){e=void 0===e?!0:e,(e===!1||e&&this._options.shy)&&(this._containerObject.style.display="none")},_setMinMax:function(e){function t(){n._min=i,n._max=o}var n=this,i={_year:Number.MIN_VALUE,_month:0,_day:1},o={_year:Number.MAX_VALUE,_month:11,_day:31};if(!e)return t();var s=e.split(":"),a=/^(\d{4})((\-)(\d{1,2})((\-)(\d{1,2}))?)?$/;r.each([{name:"_min",date:s[0],noLim:i},{name:"_max",date:s[1],noLim:o}],Ink.bind(function(e){var t=e.noLim;if("NOW"===e.date.toUpperCase()){var n=new Date;t=c(n)}else a.test(e.date)&&(t=h(e.date),t._month=l(t._month,0,11),t._day=l(t._day,1,this._daysInMonth(t._year,t._month)));this[e.name]=t},this));var d=-1!==this._dateCmp(this._max,this._min);d||t()},_fitDateToRange:function(e){return this._isValidDate(e)||(e=c(new Date)),-1===this._dateCmp(e,this._min)?Ink.extendObj({},this._min):1===this._dateCmp(e,this._max)?Ink.extendObj({},this._max):Ink.extendObj({},e)},_dateWithinRange:function(e){return arguments.length||(e=this),!this._dateAboveMax(e)&&!this._dateBelowMin(e)},_dateAboveMax:function(e){return 1===this._dateCmp(e,this._max)},_dateBelowMin:function(e){return-1===this._dateCmp(e,this._min)},_dateCmp:function(e,t){return this._dateCmpUntil(e,t,"_day")},_dateCmpUntil:function(e,t,n){var i=["_year","_month","_day"],o=-1;do{if(o++,e[i[o]]>t[i[o]])return 1;if(e[i[o]]<t[i[o]])return-1}while(i[o]!==n&&void 0!==e[i[o+1]]&&void 0!==t[i[o+1]]);return 0},_showDefaultView:function(){this._yearSelector.style.display="none",this._monthSelector.style.display="none",this._monthPrev.childNodes[0].className="change_month_prev",this._monthNext.childNodes[0].className="change_month_next",this._getPrevMonth()||(this._monthPrev.childNodes[0].className="action_inactive"),this._getNextMonth()||(this._monthNext.childNodes[0].className="action_inactive"),this._monthContainer.style.display="block"},_updateDate:function(){var e;!this._options.displayInSelect&&this._dataField.value?e=this._parseDate(this._dataField.value):this._options.displayInSelect&&(e={_year:this._options.yearField[this._options.yearField.selectedIndex].value,_month:this._options.monthField[this._options.monthField.selectedIndex].value-1,_day:this._options.dayField[this._options.dayField.selectedIndex].value}),e&&(e=this._fitDateToRange(e),this._year=e._year,this._month=e._month,this._day=e._day),this.setDate(),this._updateDescription(),this._renderMonth()},_updateDescription:function(){this._monthChanger.innerHTML=this._options.month[this._month+1],this._deText.innerHTML=this._options.ofText,this._yearChanger.innerHTML=this._year},_showYearSelector:function(e){this._incrementViewingYear(e);var t=this._year-this._year%10,n=t-1,i="<li><ul>";i+=n>this._min._year?'<li><a href="#year_prev" class="change_year_prev">'+this._options.prevLinkText+"</a></li>":"<li>&nbsp;</li>";for(var o=1;11>o;o++)0===o%4&&(i+="</ul><ul>"),n=t+o-1,i+=this._getYearButtonHtml(n);i+=n<this._max._year?'<li><a href="#year_next" class="change_year_next">'+this._options.nextLinkText+"</a></li>":"<li>&nbsp;</li>",i+="</ul></li>",this._yearSelector.innerHTML=i,this._monthPrev.childNodes[0].className="action_inactive",this._monthNext.childNodes[0].className="action_inactive",this._monthSelector.style.display="none",this._monthContainer.style.display="none",this._yearSelector.style.display="block"},_incrementViewingYear:function(e){if(e){var t=+this._year+10*e;t-=t%10,t>this._max._year||t+9<this._min._year||(this._year=+this._year+10*e)}},_getYearButtonHtml:function(e){if(this._acceptableYear({_year:e})){var t=e===this._year?' class="ink-calendar-on"':"";return'<li><a href="#" data-cal-year="'+e+'"'+t+">"+e+"</a></li>"}return'<li><a href="#" class="ink-calendar-off">'+e+"</a></li>"},_showMonthSelector:function(){this._yearSelector.style.display="none",this._monthContainer.style.display="none",this._monthPrev.childNodes[0].className="action_inactive",this._monthNext.childNodes[0].className="action_inactive",this._addMonthClassNames(),this._monthSelector.style.display="block"},_parseDate:function(e){var t=s.set(this._options.format,e);return t?c(t):null},_isValidDate:function(e){var t=/^\d{4}$/,n=/^\d{1,2}$/;return t.test(e._year)&&n.test(e._month)&&n.test(e._day)&&+e._month+1>=1&&+e._month+1<=12&&+e._day>=1&&+e._day<=this._daysInMonth(e._year,e._month+1)},_isDate:function(e,t){try{if("undefined"==typeof e)return!1;var n=s.set(e,t);if(n&&this._isValidDate(c(n)))return!0}catch(i){}return!1},_acceptableDay:function(e){return this._acceptableDateComponent(e,"validDayFn")},_acceptableMonth:function(e){return this._acceptableDateComponent(e,"validMonthFn")},_acceptableYear:function(e){return this._acceptableDateComponent(e,"validYearFn")},_acceptableDateComponent:function(e,t){return this._options[t]?this._callUserCallbackBool(this._options[t],e):this._dateWithinRange(e)},_writeDateInFormat:function(){return s.get(this._options.format,this.getDate())},setDate:function(e){if(/\d{4}-\d{1,2}-\d{1,2}/.test(e)){var t=e.split("-");this._year=+t[0],this._month=+t[1]-1,this._day=+t[2]}this._setDate()},getDate:function(){if(!this._day)throw"Ink.UI.DatePicker: Still picking a date. Cannot getDate now!";return new Date(this._year,this._month,this._day)},_setDate:function(e){if(e){var t=i.data(e);this._day=+t.calDay||this._day}var n=this._fitDateToRange(this);this._year=n._year,this._month=n._month,this._day=n._day,this._options.displayInSelect?(this._options.dayField.value=this._day,this._options.monthField.value=this._month+1,this._options.yearField.value=this._year):this._dataField.value=this._writeDateInFormat(),this._options.onSetDate&&this._options.onSetDate(this,{date:this.getDate()})},_updateCal:function(e){"function"==typeof this._options.onMonthSelected&&this._options.onMonthSelected(this,{year:this._year,month:this._month}),e&&null===this._updateMonth(e)||this._renderMonth()},_daysInMonth:function(e,t){var n={2:0===e%400||0===e%4&&0!==e%100?29:28,4:30,6:30,9:30,11:30};return n[t]||31},_updateMonth:function(e){var t;return e>0?t=this._getNextMonth():0>e&&(t=this._getPrevMonth()),t?(this._year=t._year,this._month=t._month,this._day=t._day,void 0):null},_getNextMonth:function(e){return this._tryLeap(e,"Month","next",function(e){return e._month+=1,e._month>11&&(e._month=0,e._year+=1),e})},_getPrevMonth:function(e){return this._tryLeap(e,"Month","prev",function(e){return e._month-=1,e._month<0&&(e._month=11,e._year-=1),e})},_getPrevYear:function(e){return this._tryLeap(e,"Year","prev",function(e){return e._year-=1,e})},_getNextYear:function(e){return this._tryLeap(e,"Year","next",function(e){return e._year+=1,e})},_tryLeap:function(e,t,n,i){e=e||{_year:this._year,_month:this._month,_day:this._day};var o="prev"===n?"_min":"_max",r=this[o];if(0===this._dateCmpUntil(e,r,t))return null;var s=this._options[n+"ValidDateFn"];return s?this._callUserCallbackDate(s,e):(e=i(e),e=this._fitDateToRange(e),this["_acceptable"+t](e)?e:null)},_getNextDecade:function(e){e=e||{_year:this._year,_month:this._month,_day:this._day};var t=this._getCurrentDecade(e);return t+10>this._max._year?null:t+10},_getPrevDecade:function(e){e=e||{_year:this._year,_month:this._month,_day:this._day};var t=this._getCurrentDecade(e);return t-10<this._min._year?null:t-10},_getCurrentDecade:function(e){return e=e?e._year||e:this._year,10*Math.floor(e/10)},_callUserCallbackBase:function(e,t){return e.call(this,t._year,t._month+1,t._day)},_callUserCallbackBool:function(e,t){return!!this._callUserCallbackBase(e,t)},_callUserCallbackDate:function(e,t){var n=this._callUserCallbackBase(e,t);return n?c(n):null},_dateParsers:{"yyyy-mm-dd":"Y-m-d","yyyy/mm/dd":"Y/m/d","yy-mm-dd":"y-m-d","yy/mm/dd":"y/m/d","dd-mm-yyyy":"d-m-Y","dd/mm/yyyy":"d/m/Y","dd-mm-yy":"d-m-y","dd/mm/yy":"d/m/y","mm/dd/yyyy":"m/d/Y","mm-dd-yyyy":"m-d-Y"},_renderMonth:function(){var e=this._month,t=this._year,n=new Date(t,e,1).getDay(),i=this._options.startWeekDay||0;this._showDefaultView(),i>n?n=7+i-n:n+=i;var o="";o+=this._getMonthCalendarHeaderHtml(i);var r=0;o+="<ul>";var s='<li class="ink-calendar-empty">&nbsp;</li>';if(0!==n){var l=n-i-1;r+=l,o+=a(l,s)}o+=this._getDayButtonsHtml(r,t,e),o+="</ul>",this._monthContainer.innerHTML=o},_getDayButtonsHtml:function(e,t,n){for(var i=this._daysInMonth(t,n),o="",r=1;i>=r;r++)7===e&&(e=0,o+="<ul>"),o+=this._getDayButtonHtml(t,n,r),e++,7===e&&(o+="</ul>");return o},_getDayButtonHtml:function(e,t,n){var i=" ",o=d(e,t,n);return i+=this._acceptableDay(o)?'data-cal-day="'+n+'"':'class="ink-calendar-off"',this._day&&0===this._dateCmp(o,this)&&(i+='class="ink-calendar-on" data-cal-day="'+n+'"'),'<li><a href="#" '+i+">"+n+"</a></li>"},_getMonthCalendarHeaderHtml:function(e){for(var t,n='<ul class="ink-calendar-header">',i=0;7>i;i++)t=(e+i)%7,n+="<li>"+this._options.wDay[t].substring(0,1)+"</li>";return n+"</ul>"},_addMonthClassNames:function(e){r.forEach((e||this._monthSelector).getElementsByTagName("a"),Ink.bindMethod(this,"_addMonthButtonClassNames"))},_addMonthButtonClassNames:function(e){var t=i.data(e);if(!t.calMonth)throw"not a calendar month button!";var o=+t.calMonth-1;if(o===this._month)n.addClassName(e,"ink-calendar-on"),n.removeClassName(e,"ink-calendar-off");else{n.removeClassName(e,"ink-calendar-on");var r=!this._acceptableMonth({_year:this._year,_month:o});n.addRemoveClassName(e,"ink-calendar-off",r)}},lang:function(e){this._lang=e},showMonth:function(){this._renderMonth()},isMonthRendered:function(){var e=o.select(".ink-calendar-header",this._containerObject)[0];return"none"!==n.getStyle(e.parentNode,"display")&&"none"!==n.getStyle(e.parentNode.parentNode,"display")}},u});
Ink.createModule("Ink.UI.Tooltip","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Element_1","Ink.Dom.Selector_1","Ink.Util.Array_1","Ink.Dom.Css_1","Ink.Dom.Browser_1"],function(e,t,n,i,o,r){"use strict";function s(e,t){this._init(e,t||{})}function a(e,t){this._init(e,t)}var l,h,d;!function(){for(var e=document.createElement("DIV"),t=["transition","oTransition","msTransition","mozTransition","webkitTransition"],n=0;n<t.length;n++)if("undefined"!=typeof e.style[t[n]+"Duration"]){l=t[n]+"Duration",h=t[n]+"Property",d=t[n]+"TimingFunction";break}}();var c=document.getElementsByTagName("body"),u=c&&c.length?c[0]:document.documentElement;return s.prototype={_init:function(e,t){var n;if(this.options=Ink.extendObj({where:"up",zIndex:1e4,left:10,top:10,spacing:8,forever:0,color:"",timeout:0,delay:0,template:null,templatefield:null,fade:.3,text:""},t||{}),"string"==typeof e)n=i.select(e);else{if("object"!=typeof e)throw"Element expected";n=[e]}this.tooltips=[];for(var o=0,r=n.length;r>o;o++)this.tooltips[o]=new a(this,n[o])},destroy:function(){o.each(this.tooltips,function(e){e._destroy()}),this.tooltips=null,this.options=null}},a.prototype={_oppositeDirections:{left:"right",right:"left",up:"down",down:"up"},_init:function(e,n){t.observe(n,"mouseover",Ink.bindEvent(this._onMouseOver,this)),t.observe(n,"mouseout",Ink.bindEvent(this._onMouseOut,this)),t.observe(n,"mousemove",Ink.bindEvent(this._onMouseMove,this)),this.root=e,this.element=n,this._delayTimeout=null,this.tooltip=null},_makeTooltip:function(e){if(!this._getOpt("text")&&!this._getOpt("html")&&!n.hasAttribute(this.element,"title"))return!1;var i=this._createTooltipElement();this.tooltip&&this._removeTooltip(),this.tooltip=i,this._fadeInTooltipElement(i),this._placeTooltipElement(i,e),t.observe(i,"mouseover",Ink.bindEvent(this._onTooltipMouseOver,this));var o=this._getFloatOpt("timeout");o&&setTimeout(Ink.bind(function(){this.tooltip===i&&this._removeTooltip()},this),1e3*o)},_createTooltipElement:function(){var t,o,s=this._getOpt("template"),a=this._getOpt("templatefield");if(s){var l=document.createElement("DIV");if(l.innerHTML=e.elOrSelector(s,"options.template").outerHTML,t=l.firstChild,a){if(o=i.select(a,t),!o)throw"options.templatefield must be a valid selector within options.template";o=o[0]}else o=t}else t=document.createElement("DIV"),r.addClassName(t,"ink-tooltip"),r.addClassName(t,this._getOpt("color")),o=document.createElement("DIV"),r.addClassName(o,"content"),t.appendChild(o);return this._getOpt("html")?o.innerHTML=this._getOpt("html"):this._getOpt("text")?n.setTextContent(o,this._getOpt("text")):n.setTextContent(o,this.element.getAttribute("title")),t.style.display="block",t.style.position="absolute",t.style.zIndex=this._getIntOpt("zIndex"),t},_fadeInTooltipElement:function(e){var t=this._getFloatOpt("fade");l&&t&&(e.style.opacity="0",e.style[l]=t+"s",e.style[h]="opacity",e.style[d]="ease-in-out",setTimeout(function(){e.style.opacity="1"},0))},_placeTooltipElement:function(e,t){var i=this._getOpt("where");if("mousemove"===i||"mousefix"===i){var o=t;this._setPos(o[0],o[1]),u.appendChild(e)}else if(i.match(/(up|down|left|right)/)){u.appendChild(e);var s=n.offset(this.element),a=s[0],l=s[1],h=n.elementWidth(this.element)/2-n.elementWidth(e)/2,d=n.elementHeight(this.element)/2-n.elementHeight(e)/2,c=this._getIntOpt("spacing"),p=n.elementDimensions(e),m=n.elementDimensions(this.element),f=n.scrollWidth()+n.viewportWidth(),_=n.scrollHeight()+n.viewportHeight();i=this._getWhereValueInsideViewport(i,{left:a-p[0],right:a+p[0],top:l+p[1],bottom:l+p[1]},{right:f,bottom:_}),"up"===i?(l-=p[1],l-=c,a+=h):"down"===i?(l+=m[1],l+=c,a+=h):"left"===i?(a-=p[0],a-=c,l+=d):"right"===i&&(a+=m[0],a+=c,l+=d);var g=null;i.match(/(up|down|left|right)/)&&(g=document.createElement("SPAN"),r.addClassName(g,"arrow"),r.addClassName(g,this._oppositeDirections[i]),e.appendChild(g));var v=a,y=l,b=y+p[1]-_,k=v+p[0]-f,C=0-v,w=0-y;b>0?(g&&(g.style.top=p[1]/2+b+"px"),y-=b):w>0?(g&&(g.style.top=p[1]/2-w+"px"),y+=w):k>0?(g&&(g.style.left=p[0]/2+k+"px"),v-=k):C>0&&(g&&(g.style.left=p[0]/2-C+"px"),v+=C),e.style.left=v+"px",e.style.top=y+"px"}},_getWhereValueInsideViewport:function(e,t,n){return"left"===e&&t.left<0?"right":"right"===e&&t.right>n.right?"left":"up"===e&&t.top<0?"down":"down"===e&&t.bottom>n.bottom?"up":e},_removeTooltip:function(){var e=this.tooltip;if(e){var t=Ink.bind(n.remove,{},e);"mousemove"!==this._getOpt("where")&&l?(e.style.opacity=0,setTimeout(t,1e3*this._getFloatOpt("fade"))):t(),this.tooltip=null}},_getOpt:function(e){var t=n.data(this.element)[n._camelCase("tip-"+e)];if(t)return t;var i=this.root.options[e];return"undefined"!=typeof i?i:void 0},_getIntOpt:function(e){return parseInt(this._getOpt(e),10)},_getFloatOpt:function(e){return parseFloat(this._getOpt(e),10)},_destroy:function(){this.tooltip&&n.remove(this.tooltip),this.root=null,this.element=null,this.tooltip=null},_onMouseOver:function(e){var t=this._getMousePosition(e),n=this._getFloatOpt("delay");n?this._delayTimeout=setTimeout(Ink.bind(function(){this.tooltip||this._makeTooltip(t),this._delayTimeout=null},this),1e3*n):this._makeTooltip(t)},_onMouseMove:function(e){if("mousemove"===this._getOpt("where")&&this.tooltip){var t=this._getMousePosition(e);this._setPos(t[0],t[1])}},_onMouseOut:function(){this._getIntOpt("forever")||this._removeTooltip(),this._delayTimeout&&(clearTimeout(this._delayTimeout),this._delayTimeout=null)},_onTooltipMouseOver:function(){this.tooltip&&this._removeTooltip()},_setPos:function(e,t){e+=this._getIntOpt("left"),t+=this._getIntOpt("top");var i=this._getPageXY();if(this.tooltip){var o=[n.elementWidth(this.tooltip),n.elementHeight(this.tooltip)],r=this._getScroll();o[0]+e-r[0]>=i[0]-20&&(e=e-o[0]-this._getIntOpt("left")-10),o[1]+t-r[1]>=i[1]-20&&(t=t-o[1]-this._getIntOpt("top")-10),this.tooltip.style.left=e+"px",this.tooltip.style.top=t+"px"}},_getPageXY:function(){var e=0,t=0;return"number"==typeof window.innerWidth?(e=window.innerWidth,t=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(e=document.body.clientWidth,t=document.body.clientHeight),[parseInt(e,10),parseInt(t,10)]},_getScroll:function(){var e=document.documentElement,t=document.body;return e&&(e.scrollLeft||e.scrollTop)?[e.scrollLeft,e.scrollTop]:t?[t.scrollLeft,t.scrollTop]:[0,0]},_getMousePosition:function(e){return[parseInt(t.pointerX(e),10),parseInt(t.pointerY(e),10)]}},s});
Ink.createModule("Ink.UI.Close","1",["Ink.Dom.Event_1","Ink.Dom.Element_1"],function(e,t){"use strict";var n=function(){e.observe(document.body,"click",function(n){var i=e.element(n);if(i=t.findUpwardsByClass(i,"ink-close")||t.findUpwardsByClass(i,"ink-dismiss")){var o=i;o=t.findUpwardsByClass(i,"ink-alert")||t.findUpwardsByClass(i,"ink-alert-block"),o&&(e.stop(n),t.remove(o))}})};return n});
Ink.createModule("Ink.UI.Carousel","1",["Ink.UI.Common_1","Ink.Dom.Event_1","Ink.Dom.Css_1","Ink.Dom.Element_1","Ink.UI.Pagination_1","Ink.Dom.Browser_1","Ink.Dom.Selector_1"],function(e,t,n,i,o,r){"use strict";function s(e,t){e.style.transitionProperty=e.style.oTransitionProperty=e.style.msTransitionProperty=e.style.mozTransitionProperty=e.style.webkitTransitionProperty=t}var a=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return setTimeout(e,1e3/30)},l=function(n,r){this._handlers={paginationChange:Ink.bindMethod(this,"_onPaginationChange"),windowResize:Ink.bindMethod(this,"refit")},t.observe(window,"resize",this._handlers.windowResize);var s=this._element=e.elOrSelector(n,"1st argument"),a=this._options=Ink.extendObj({axis:"x",hideLast:!1,center:!1,keyboardSupport:!1,pagination:null,onChange:null,swipe:!0},r||{},i.data(s));this._isY="y"===a.axis;var l=Ink.s("ul.stage",s);if(this._ulEl=l,i.removeTextNodeChildren(l),a.hideLast){var h=i.create("div",{className:"hider",insertBottom:this._element});h.style.position="absolute",h.style[this._isY?"left":"top"]="0",h.style[this._isY?"right":"bottom"]="0",h.style[this._isY?"bottom":"right"]="0",this._hiderEl=h}this.refit(),this._isY&&(this._ulEl.style.whiteSpace="normal");var u;a.pagination&&(e.isDOMElement(a.pagination)||"string"==typeof a.pagination?u=this._pagination=new o(a.pagination,{size:this._numPages,onChange:this._handlers.paginationChange}):(u=this._pagination=a.pagination,this._pagination._options.onChange=this._handlers.paginationChange,this._pagination.setSize(this._numPages),this._pagination.setCurrent(0))),a.swipe&&(t.observe(s,"touchstart",Ink.bindMethod(this,"_onTouchStart")),t.observe(s,"touchmove",Ink.bindMethod(this,"_onTouchMove")),t.observe(s,"touchend",Ink.bindMethod(this,"_onTouchEnd")))};return l.prototype={refit:function(){var e=this._isY,t=function(t,n){return n?i.outerDimensions(t)[e?0:1]:i.outerDimensions(t)[e?1:0]};this._liEls=Ink.ss("li.slide",this._ulEl);var n=this._liEls.length;this._ctnLength=t(this._element),this._elLength=t(this._liEls[0]),this._itemsPerPage=Math.floor(this._ctnLength/this._elLength);var o=Math.ceil(n/this._itemsPerPage),r=this._numPages!==o;this._numPages=o,this._deltaLength=this._itemsPerPage*this._elLength,this._isY?(this._element.style.width=t(this._liEls[0],!0)+"px",this._ulEl.style.width=t(this._liEls[0],!0)+"px"):this._ulEl.style.height=t(this._liEls[0],!0)+"px",this._center(),this._updateHider(),this._IE7(),this._pagination&&r&&(this._pagination.setSize(this._numPages),this._pagination.setCurrent(0))},_center:function(){if(this._options.center){var e,t=Math.floor((this._ctnLength-this._elLength*this._itemsPerPage)/2);e=this._isY?[t,"px 0"]:["0 ",t,"px"],this._ulEl.style.padding=e.join("")}},_updateHider:function(){if(this._hiderEl)if(this._pagination&&0!==this._pagination.getCurrent())this._hiderEl.style[this._isY?"height":"width"]="0px";else{var e=Math.floor(this._ctnLength-this._elLength*this._itemsPerPage);this._options.center&&(e/=2),this._hiderEl.style[this._isY?"height":"width"]=e+"px"}},_IE7:function(){if(r.IE&&"7"==""+r.version.split(".")[0])for(var e=Ink.ss("li.slide",this._ulEl),t=function(t,i){e[n].style[t]=i},n=0,i=e.length;i>n;n++)t("position","absolute"),t(this._isY?"top":"left",n*this._elLength+"px")},_onTouchStart:function(e){if(!(e.touches.length>1)){this._swipeData={x:t.pointerX(e),y:t.pointerY(e),lastUlPos:null};var n=this._ulEl.getBoundingClientRect();this._swipeData.inUlX=this._swipeData.x-n.left,this._swipeData.inUlY=this._swipeData.y-n.top,s(this._ulEl,"none"),this._touchMoveIsFirstTouchMove=!0,e.stopPropagation()}},_onTouchMove:function(e){if(!(e.touches.length>1)){var n=t.pointerX(e),i=t.pointerY(e),o=Math.abs(i-this._swipeData.y),r=Math.abs(n-this._swipeData.x);this._touchMoveIsFirstTouchMove&&(this._touchMoveIsFirstTouchMove=void 0,this._scrolling=this._isY?r>o:o>r,this._scrolling||this._onAnimationFrame()),!this._scrolling&&this._swipeData&&(e.preventDefault(),this._swipeData.pointerPos=this._isY?i:n),e.stopPropagation()}},_onAnimationFrame:function(){var e=this._swipeData;if(e&&!this._scrolling&&!this._touchMoveIsFirstTouchMove){var t,n=this._element.getBoundingClientRect();t=this._isY?e.pointerPos-e.inUlY-n.top:e.pointerPos-e.inUlX-n.left,this._ulEl.style[this._isY?"top":"left"]=t+"px",e.lastUlPos=t,a(Ink.bindMethod(this,"_onAnimationFrame"))}},_onTouchEnd:function(e){if(this._swipeData&&this._swipeData.pointerPos&&!this._scrolling&&!this._touchMoveIsFirstTouchMove){var t=.1,n=-this._swipeData.lastUlPos,i=this._pagination.getCurrent(),o=n/this._elLength/this._itemsPerPage;if(Math.round(o)===i){var r=o-i;Math.abs(r)>t&&(r=r>0?1:-1,i+=r)}else i=Math.round(o);isNaN(i)||this._pagination.setCurrent(i),e.stopPropagation()}s(this._ulEl,null),this._swipeData=null,this._touchMoveIsFirstTouchMove=void 0,this._scrolling=void 0},_onPaginationChange:function(e){var t=e.getCurrent();this._ulEl.style["y"===this._options.axis?"top":"left"]=["-",t*this._deltaLength,"px"].join(""),this._options.onChange&&this._options.onChange.call(this,t),this._updateHider()}},l});
Ink.createModule("Ink.UI.ProgressBar","1",["Ink.Dom.Selector_1","Ink.Dom.Element_1"],function(e,t){"use strict";var n=function(n,i){if("object"!=typeof n){if("string"!=typeof n)throw"[Ink.UI.ProgressBar] :: Invalid selector";if(this._element=e.select(n),this._element.length<1)throw"[Ink.UI.ProgressBar] :: Selector didn't find any elements";this._element=this._element[0]}else this._element=n;this._options=Ink.extendObj({startValue:0,onStart:function(){},onEnd:function(){}},t.data(this._element)),this._options=Ink.extendObj(this._options,i||{}),this._value=this._options.startValue,this._init()};return n.prototype={_init:function(){if(this._elementBar=e.select(".bar",this._element),this._elementBar.length<1)throw"[Ink.UI.ProgressBar] :: Bar element not found";this._elementBar=this._elementBar[0],this._options.onStart=Ink.bind(this._options.onStart,this),this._options.onEnd=Ink.bind(this._options.onEnd,this),this.setValue(this._options.startValue)},setValue:function(e){this._options.onStart(this._value),e=parseInt(e,10),isNaN(e)||0>e?e=0:e>100&&(e=100),this._value=e,this._elementBar.style.width=this._value+"%",this._options.onEnd(this._value)}},n});